!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Mars=e()}}(function(){var e;return function(){function e(t,r,n){function o(u,s){if(!r[u]){if(!t[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[u]={exports:{}};t[u][0].call(f.exports,function(e){var r=t[u][1][e];return o(r||e)},f,f.exports,e,t,r,n)}return r[u].exports}for(var i="function"==typeof require&&require,u=0;u<n.length;u++)o(n[u]);return o}return e}()({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("eventemitter3"),f=n(c),l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),a(t,[{key:"emitAsync",value:function(e,t,r,n,o,i){var u=f["default"].prefixed,s=u?u+e:e;if(!this._events||!this._events[s])return Promise.resolve();var a=void 0,c=this._events[s],l=arguments.length,d=void 0;if("function"==typeof c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return Promise.resolve(c.fn.call(c.context));case 2:return Promise.resolve(c.fn.call(c.context,t));case 3:return Promise.resolve(c.fn.call(c.context,t,r));case 4:return Promise.resolve(c.fn.call(c.context,t,r,n));case 5:return Promise.resolve(c.fn.call(c.context,t,r,n,o));case 6:return Promise.resolve(c.fn.call(c.context,t,r,n,o,i))}for(a=1,d=new Array(l-1);a<l;a++)d[a-1]=arguments[a];return Promise.resolve(c.fn.apply(c.context,d))}var h=[],p=c.length,b=void 0;for(a=0;a<p;a++)switch(c[a].once&&this.removeListener(e,c[a].fn,void 0,!0),l){case 1:h.push(Promise.resolve(c[a].fn.call(c[a].context)));break;case 2:h.push(Promise.resolve(c[a].fn.call(c[a].context,t)));break;case 3:h.push(Promise.resolve(c[a].fn.call(c[a].context,t,r)));break;default:if(!d)for(b=1,d=new Array(l-1);b<l;b++)d[b-1]=arguments[b];h.push(Promise.resolve(c[a].fn.apply(c[a].context,d)))}return Promise.all(h)}}]),t}(f["default"]);r["default"]=l},{eventemitter3:35}],2:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u={};!function(){for(var e=0;e<i.length;e++)u[i.charAt(e)]=e}();var s=function(e){return i.charAt(e)},a=function(e){return"="===e?-1:u[e]},c=r.Base64=function(){function e(){n(this,e)}return o(e,[{key:"encode",value:function(e){if("string"==typeof e){var t=e;e=this.newBinary(t.length);for(var r=0;r<t.length;r++){var n=t.charCodeAt(r);if(n>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[r]=n}}for(var o=[],i=null,u=null,a=null,c=null,f=0;f<e.length;f++)switch(f%3){case 0:i=e[f]>>2&63,u=(3&e[f])<<4;break;case 1:u|=e[f]>>4&15,a=(15&e[f])<<2;break;case 2:a|=e[f]>>6&3,c=63&e[f],o.push(s(i)),o.push(s(u)),o.push(s(a)),o.push(s(c)),i=null,u=null,a=null,c=null}return null!=i&&(o.push(s(i)),o.push(s(u)),null==a?o.push("="):o.push(s(a)),null==c&&o.push("=")),o.join("")}},{key:"decode",value:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var r=this.newBinary(t),n=null,o=null,i=null,u=0,s=0;s<e.length;s++){var c=e.charAt(s),f=a(c);switch(s%4){case 0:if(f<0)throw new Error("invalid base64 string");n=f<<2;break;case 1:if(f<0)throw new Error("invalid base64 string");n|=f>>4,r[u++]=n,o=(15&f)<<4;break;case 2:f>=0&&(o|=f>>2,r[u++]=o,i=(3&f)<<6);break;case 3:f>=0&&(r[u++]=i|f)}}return r}},{key:"newBinary",value:function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],r=0;r<e;r++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))}}]),e}();r["default"]=new c},{}],3:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":c(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":c(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;F+=1,$=[],D=!1;var t=F;setTimeout(function(){t===F&&(D=!0,(0,p["default"])($,function(e){return e()}),$=[])},e)}function a(){D&&console.warn("You are trying to change some default of the Collection,but all collections is already initialized. It may be happened because you are trying to configure Collection not at first execution cycle of main script. Please consider to move all configuration to first execution cycle.")}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.Collection=void 0;var f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r._resetStartup=s,r._warnIfAlreadyStarted=a;var l=e("fast.js/map"),d=n(l),h=e("fast.js/forEach"),p=n(h),b=e("check-types"),v=n(b),y=e("./AsyncEventEmitter"),m=n(y),_=e("./IndexManager"),g=n(_),O=e("./StorageManager"),j=n(O),w=e("./CollectionDelegate"),S=n(w),E=e("./CursorObservable"),P=n(E),x=e("./ShortIdGenerator"),A=n(x),I=e("./EJSON"),k=n(I),M=P["default"],N=S["default"],T=j["default"],C=g["default"],R=A["default"],D=!1,$=[],F=0;s();var B=r.Collection=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.options=r,n._modelName=e,r.inMemory&&(r.cursorClass=r.cursorClass||P["default"],r.delegate=r.delegate||S["default"],r.storageManager=r.storageManager||j["default"],r.indexManager=r.indexManager||g["default"],r.idGenerator=r.idGenerator||A["default"]),t.startup(function(){return n._lazyInitCollection()}),n}return u(t,e),f(t,[{key:"create",value:function(e){return v["default"].string(e)?k["default"].parse(e):e}},{key:"insert",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._lazyInitCollection();var n=this.idGenerator(this.modelName);return e=this.create(e),e._id=e._id||n.value,this.emit("beforeInsert",e,n),r.quiet||this.emit("sync:insert",e,n),this.delegate.insert(e,r,n).then(function(r){return t.emit("insert",e,null,n),r})}},{key:"insertAll",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all((0,d["default"])(e,function(e){return t.insert(e,r)}))}},{key:"remove",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitCollection(),this.emit("beforeRemove",e,r),r.quiet||this.emit("sync:remove",e,r),this.delegate.remove(e,r).then(function(e){return(0,p["default"])(e,function(e){return t.emit("remove",null,e)}),e})}},{key:"update",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._lazyInitCollection(),this.emit("beforeUpdate",e,t,n),n.quiet||this.emit("sync:update",e,t,n),this.delegate.update(e,t,n).then(function(e){return(0,p["default"])(e.updated,function(t,n){r.emit("update",t,e.original[n])}),e})}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitCollection(),this.delegate.find(e,t)}},{key:"findOne",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitCollection(),this.delegate.findOne(e,t)}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitCollection(),this.delegate.count(e,t)}},{key:"ids",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitCollection(),this.delegate.ids(e,t)}},{key:"_lazyInitCollection",value:function(){if(!this._initialized){this._initialized=!0;var e=this.options,t=e.storageManager||T,r=e.delegate||N,n=e.indexManager||C;this.idGenerator=e.idGenerator||R,this.cursorClass=e.cursorClass||M,this.indexManager=new n(this,e),this.storageManager=new t(this,e),this.delegate=new r(this,e)}}},{key:"modelName",get:function(){return this._modelName}},{key:"indexes",get:function(){return this._lazyInitCollection(),this.indexManager.indexes}},{key:"storage",get:function(){return this._lazyInitCollection(),this.storageManager}}],[{key:"defaultCursor",value:function(){return arguments.length>0?(a(),void(M=arguments[0])):M}},{key:"defaultStorageManager",value:function(){return arguments.length>0?(a(),void(T=arguments[0])):T}},{key:"defaultIdGenerator",value:function(){return arguments.length>0?(a(),void(R=arguments[0])):R}},{key:"defaultDelegate",value:function(){return arguments.length>0?(a(),void(N=arguments[0])):N}},{key:"defaultIndexManager",value:function(){return arguments.length>0?(a(),void(C=arguments[0])):C}},{key:"startup",value:function(e){D?e():$.push(e)}}]),t}(m["default"]);r["default"]=B},{"./AsyncEventEmitter":1,"./CollectionDelegate":4,"./CursorObservable":7,"./EJSON":14,"./IndexManager":15,"./ShortIdGenerator":19,"./StorageManager":20,"check-types":33,"fast.js/forEach":43,"fast.js/map":50}],4:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.CollectionDelegate=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("fast.js/map"),a=n(s),c=e("./DocumentModifier"),f=n(c),l=r.CollectionDelegate=function(){function e(t){i(this,e),this.db=t}return u(e,[{key:"insert",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments[2];return this.db.indexManager.indexDocument(e).then(function(){return t.db.storageManager.persist(e._id,e).then(function(){return e._id})})}},{key:"remove",value:function(e,t){var r=this,n=t.sort,i=void 0===n?{_id:1}:n,u=t.multi,s=void 0!==u&&u;return this.find(e,{noClone:!0}).sort(i).then(function(e){e.length>1&&!s&&(e=[e[0]]);var t=(0,a["default"])(e,function(e){return r.db.storageManager["delete"](e._id)}),n=(0,a["default"])(e,function(e){return r.db.indexManager.deindexDocument(e)});return Promise.all([].concat(o(t),o(n))).then(function(){return e})})}},{key:"update",value:function(e,t,r){var n=this,i=r.sort,u=void 0===i?{_id:1}:i,s=r.multi,c=void 0!==s&&s,l=r.upsert,d=void 0!==l&&l;return this.find(e,{noClone:!0}).sort(u).then(function(r){return r.length>1&&!c&&(r=[r[0]]),new f["default"](e).modify(r,t,{upsert:d})}).then(function(e){var t=e.original,r=e.updated,i=(0,a["default"])(r,function(e){return n.db.storageManager.persist(e._id,e)}),u=(0,a["default"])(r,function(e,r){return n.db.indexManager.reindexDocument(t[r],e)});return Promise.all([].concat(o(i),o(u))).then(function(){return{modified:r.length,original:t,updated:r}})})}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.db.cursorClass;return new r(this.db,e,t)}},{key:"findOne",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,t).aggregate(function(e){return e[0]}).limit(1)}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.noClone=!0,this.find(e,t).aggregate(function(e){return e.length})}},{key:"ids",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.noClone=!0,this.find(e,t).map(function(e){return e._id})}}]),e}();r["default"]=l},{"./DocumentModifier":10,"fast.js/map":50}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.CollectionIndex=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("invariant"),s=n(u),a=r.CollectionIndex=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),(0,s["default"])(t.fieldName,'CollectionIndex(...): you must specify a "feildName" option'),(0,s["default"])(!Array.isArray(t.fieldName),"CollectionIndex(...): compound index is not supported yet"),this.fieldName=t.fieldName,this.unique=t.unique||!1,this.sparse=t.sparse||!1,this.reset()}return i(e,[{key:"reset",value:function(){}},{key:"insert",value:function(e){}},{key:"remove",value:function(e){}},{key:"update",value:function(e,t){}},{key:"getMatching",value:function(e){}},{key:"getBetweenBounds",value:function(e){}},{key:"getAll",value:function(e){}}]),e}();r["default"]=a},{invariant:57}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.Cursor=r.PIPELINE_PROCESSORS=void 0;var a="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":s(e)},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=e("fast.js/forEach"),d=n(l),h=e("fast.js/object/assign"),p=n(h),b=e("fast.js/object/keys"),v=n(b),y=e("fast.js/map"),m=n(y),_=e("./AsyncEventEmitter"),g=n(_),O=e("invariant"),j=n(O),w=e("./DocumentRetriver"),S=n(w),E=e("./DocumentMatcher"),P=n(E),x=e("./DocumentSorter"),A=n(x),I=e("./DocumentProjector"),k=n(I),M=e("./EJSON"),N=n(M),T=0,C=r.PIPELINE_PROCESSORS=f({},e("./cursor-processors/filter"),e("./cursor-processors/sortFunc"),e("./cursor-processors/map"),e("./cursor-processors/aggregate"),e("./cursor-processors/reduce"),e("./cursor-processors/join"),e("./cursor-processors/joinEach"),e("./cursor-processors/joinAll"),e("./cursor-processors/joinObj"),e("./cursor-processors/ifNotEmpty")),R=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),t}(g["default"]);(0,d["default"])(C,function(e,t){R.prototype[t]=e.method});var D=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u.db=e,u.options=n,u._id=T++,u._query=r,u._pipeline=[],u._latestResult=null,u._childrenCursors={},u._parentCursors={},u._ensureMatcherSorter(),u}return u(t,e),c(t,[{key:"skip",value:function(e){return(0,j["default"])(e>=0||"undefined"==typeof e,"skip(...): skip must be a positive number"),this._skip=e,this}},{key:"limit",value:function(e){return(0,j["default"])(e>=0||"undefined"==typeof e,"limit(...): limit must be a positive number"),this._limit=e,this}},{key:"find",value:function(e){return this._query=e,this._ensureMatcherSorter(),this}},{key:"project",value:function(e){return e?this._projector=new k["default"](e):this._projector=null,this}},{key:"sort",value:function(e){return(0,j["default"])("object"===("undefined"==typeof e?"undefined":a(e))||"undefined"==typeof e||Array.isArray(e),"sort(...): argument must be an object"),this._sort=e,this._ensureMatcherSorter(),this}},{key:"exec",value:function(){var e=this;return this.emit("beforeExecute"),this._createCursorPromise(this._doExecute().then(function(t){return e._latestResult=t,t}))}},{key:"then",value:function(e,t){return this.exec().then(e,t)}},{key:"_addPipeline",value:function(e,t){(0,j["default"])(e&&C[e],"Unknown pipeline processor type %s",e);for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return this._pipeline.push({type:e,value:t,args:n||[]}),this}},{key:"_processPipeline",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._pipeline[r];return n?Promise.resolve(C[n.type].process(e,n,this)).then(function(e){return"___[STOP]___"===e?e:t._processPipeline(e,r+1)}):Promise.resolve(e)}},{key:"_doExecute",value:function(){var e=this;return this._matchObjects().then(function(t){var r=void 0;return r=e.options.noClone?t:e._projector?e._projector.project(t):(0,m["default"])(t,function(e){return N["default"].clone(e)}),e._processPipeline(r)})}},{key:"_matchObjects",value:function(){var e=this,t=this._limit&&!this._skip&&!this._sorter,r=t?{limit:this._limit}:{},n=function(t){return t&&e._matcher.documentMatches(t).result};return new S["default"](this.db).retriveForQeury(this._query,n,r).then(function(r){if(t)return r;if(e._sorter){var n=e._sorter.getComparator();r.sort(n)}var o=e._skip||0,i=e._limit||r.length;return r.slice(o,i+o)})}},{key:"_ensureMatcherSorter",value:function(){this._sorter=void 0,this._matcher=new P["default"](this._query||{}),(this._matcher.hasGeoQuery||this._sort)&&(this._sorter=new A["default"](this._sort||[],{matcher:this._matcher}))}},{key:"_trackChildCursorPromise",value:function(e){var t=this,r=e.cursor;this._childrenCursors[r._id]=r,r._parentCursors[this._id]=this,this.once("beforeExecute",function(){delete t._childrenCursors[r._id],delete r._parentCursors[t._id],0===(0,v["default"])(r._parentCursors).length&&r.emit("beforeExecute")})}},{key:"_createCursorPromise",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,p["default"])({cursor:this,then:function(n,o){return t._createCursorPromise(e.then(n,o),r)}},r)}}]),t}(R);r.Cursor=D,r["default"]=D},{"./AsyncEventEmitter":1,"./DocumentMatcher":9,"./DocumentProjector":11,"./DocumentRetriver":12,"./DocumentSorter":13,"./EJSON":14,"./cursor-processors/aggregate":21,"./cursor-processors/filter":22,"./cursor-processors/ifNotEmpty":23,"./cursor-processors/join":24,"./cursor-processors/joinAll":25,"./cursor-processors/joinEach":26,"./cursor-processors/joinObj":27,"./cursor-processors/map":28,"./cursor-processors/reduce":29,"./cursor-processors/sortFunc":30,"fast.js/forEach":43,"fast.js/map":50,"fast.js/object/assign":51,"fast.js/object/keys":53,invariant:57}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.CursorObservable=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function I(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:I(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},f=e("fast.js/function/bind"),l=n(f),d=e("check-types"),h=n(d),p=e("fast.js/object/values"),b=n(p),v=e("fast.js/map"),y=n(v),m=e("./Cursor"),_=n(m),g=e("./EJSON"),O=n(g),j=e("./PromiseQueue"),w=n(j),S=e("./debounce"),E=n(S),P=1e3/60,x=10,A=function(e){function t(e,r,n){o(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));return u.maybeUpdate=(0,l["default"])(u.maybeUpdate,u),u._observers=0,u._updateQueue=new w["default"](1),u._propagateUpdate=(0,E["default"])((0,l["default"])(u._propagateUpdate,u),0,0),u._doUpdate=(0,E["default"])((0,l["default"])(u._doUpdate,u),P,x),u}return u(t,e),a(t,[{key:"batchSize",value:function(e){return this._doUpdate.updateBatchSize(e),this}},{key:"debounce",value:function(e){return this._doUpdate.updateWait(e),this}},{key:"observe",value:function(e){function t(){r&&(r=!1,n._observers-=1,n.removeListener("update",e),n.removeListener("stop",t),0===n._observers&&(n._latestIds=null,n._latestResult=null,n._updatePromise=null,n.emit("observeStopped"),n.db.removeListener("insert",n.maybeUpdate),n.db.removeListener("update",n.maybeUpdate),n.db.removeListener("remove",n.maybeUpdate)))}arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e||function(){},this._observers<=0&&(this.db.on("insert",this.maybeUpdate),this.db.on("update",this.maybeUpdate),this.db.on("remove",this.maybeUpdate));var r=!0,n=this;this._observers+=1,this.on("update",e),this.on("stop",t),this._updatePromise?null!==this._latestResult&&e(this._latestResult):this.update(!0,!0);var o={stop:t};return this._createCursorPromise(this._updatePromise,o)}},{key:"stopObservers",value:function(){return this._doUpdate.cancel(),this.emit("stop"),this}},{key:"update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!r){if(this._updateDebPromise&&!this._updateDebPromise.debouncePassed)return this._doUpdate(t),this._updatePromise;if(!(!this._updateDebAdded||this._updateDebPromise&&this._updateDebPromise.debouncePassed))return this._updatePromise;this._updateDebAdded=!0}return this._updatePromise=this._updateQueue.add(function(){return r?e._doUpdate.func(t):(e._updateDebAdded=!0,e._updateDebPromise=e._doUpdate(t),e._updateDebPromise.then(function(){e._updateDebAdded=!1,e._updateDebPromise=null}))}),this._updatePromise}},{key:"maybeUpdate",value:function(e,t){var r=null===e&&null===t,n=r||!e&&t&&(!this._latestIds||this._latestIds.has(t._id)),o=n||e&&t&&(this._matcher.documentMatches(e).result||this._matcher.documentMatches(t).result)&&!O["default"].equals(e,t),i=o||e&&!t&&this._matcher.documentMatches(e).result;if(i)return this.update()}},{key:"_propagateUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.emitAsync("update",this._latestResult,e),r=void 0;return e||(r=Promise.all((0,b["default"])((0,y["default"])(this._parentCursors,function(e,t){if(e._propagateUpdate)return e._propagateUpdate(!1)})))),t.then(function(){return r})}},{key:"_doUpdate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.exec().then(function(r){return e._updateLatestIds(),e._propagateUpdate(t).then(function(){return r})})}},{key:"_updateLatestIds",value:function(){var e=h["default"].array(this._latestResult)?(0,y["default"])(this._latestResult,function(e){return e._id}):this._latestResult&&[this._latestResult._id];this._latestIds=new Set(e)}},{key:"_trackChildCursorPromise",value:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_trackChildCursorPromise",this).call(this,e),e.stop&&(this.once("cursorChanged",e.stop),this.once("observeStopped",e.stop),this.once("beforeExecute",e.stop))}}],[{key:"defaultDebounce",value:function(){return arguments.length>0?void(P=arguments[0]):P}},{key:"defaultBatchSize",value:function(){return arguments.length>0?void(x=arguments[0]):x}}]),t}(_["default"]);r.CursorObservable=A,r["default"]=A},{"./Cursor":6,"./EJSON":14,"./PromiseQueue":17,"./debounce":31,"check-types":33,"fast.js/function/bind":46,"fast.js/map":50,"fast.js/object/values":55}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return d["default"].string(e)||d["default"].number(e)}function i(e){return o(e)||e&&d["default"].object(e)&&e._id&&o(e._id)&&1===(0,v["default"])(e).length}function u(e){return d["default"].array(e)&&!m["default"].isBinary(e)}function s(e){return e&&3===_._type(e)}function a(e){return u(e)||s(e)}function c(e,t){if(!s(e))return!1;var r=void 0;return(0,p["default"])(e,function(n,o){var i="$"===o.substr(0,1);if(void 0===r)r=i;else if(r!==i){if(!t)throw new Error("Inconsistent operator: "+JSON.stringify(e));r=!1}}),!!r}function f(e){return/^[0-9]+$/.test(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.MongoTypeComp=void 0,r.selectorIsId=o,r.selectorIsIdPerhapsAsObject=i,r.isArray=u,r.isPlainObject=s,r.isIndexable=a,r.isOperatorObject=c,r.isNumericKey=f;var l=e("check-types"),d=n(l),h=e("fast.js/forEach"),p=n(h),b=e("fast.js/object/keys"),v=n(b),y=e("./EJSON"),m=n(y),_=r.MongoTypeComp={_type:function(e){return"number"==typeof e?1:"string"==typeof e?2:"boolean"==typeof e?8:u(e)?4:null===e?10:e instanceof RegExp?11:"function"==typeof e?13:e instanceof Date?9:m["default"].isBinary(e)?5:3},_equal:function(e,t){return m["default"].equals(e,t,{keyOrderSensitive:!0})},_typeorder:function(e){return[-1,1,2,3,4,5,-1,6,7,8,0,9,-1,100,2,100,1,8,1][e]},_cmp:function(e,t){if(void 0===e)return void 0===t?0:-1;if(void 0===t)return 1;var r=_._type(e),n=_._type(t),o=_._typeorder(r),i=_._typeorder(n);if(o!==i)return o<i?-1:1;if(r!==n)throw Error("Missing type coercion logic in _cmp");if(7===r&&(r=n=2,e=e.toHexString(),t=t.toHexString()),9===r&&(r=n=1,e=e.getTime(),t=t.getTime()),1===r)return e-t;if(2===n)return e<t?-1:e===t?0:1;if(3===r){var u=function(e){var t=[];for(var r in e)t.push(r),t.push(e[r]);return t};return _._cmp(u(e),u(t))}if(4===r)for(var s=0;;s++){if(s===e.length)return s===t.length?0:-1;if(s===t.length)return 1;var a=_._cmp(e[s],t[s]);if(0!==a)return a}if(5===r){if(e.length!==t.length)return e.length-t.length;for(s=0;s<e.length;s++){if(e[s]<t[s])return-1;if(e[s]>t[s])return 1}return 0}if(8===r)return e?t?0:1:t?-1:0;if(10===r)return 0;if(11===r)throw Error("Sorting not supported on regular expression");if(13===r)throw Error("Sorting not supported on Javascript code");throw Error("Unknown type to sort")}}},{"./EJSON":14,"check-types":33,"fast.js/forEach":43,"fast.js/object/keys":53}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return function(t){return t instanceof RegExp?String(t)===String(e):"string"==typeof t&&(e.lastIndex=0,e.test(t))}}function u(e){if((0,k.isOperatorObject)(e))throw Error("Can't create equalityValueSelector for operator object");return null==e?function(e){return null==e}:function(t){return k.MongoTypeComp._equal(e,t)}}function s(e,t){t=t||{};var r,n=e.split("."),o=n.length?n[0]:"",i=(0,k.isNumericKey)(o),u=n.length>=2&&(0,k.isNumericKey)(n[1]);n.length>1&&(r=s(n.slice(1).join(".")));var a=function(e){return e.dontIterate||delete e.dontIterate,e.arrayIndices&&!e.arrayIndices.length&&delete e.arrayIndices,e};return function(e,n){if(n||(n=[]),(0,k.isArray)(e)){if(!(i&&o<e.length))return[];n=n.concat(+o,"x")}var s=e[o];if(!r)return[a({value:s,dontIterate:(0,k.isArray)(e)&&(0,k.isArray)(s),arrayIndices:n})];if(!(0,k.isIndexable)(s))return(0,k.isArray)(e)?[]:[a({value:void 0,arrayIndices:n})];var c=[],f=function(e){Array.prototype.push.apply(c,e)};return f(r(s,n)),!(0,k.isArray)(s)||u&&t.forSort||(0,b["default"])(s,function(e,t){(0,k.isPlainObject)(e)&&f(r(e,n.concat(t)))}),c}}function a(e,t){var r=[];return(0,b["default"])(e,function(e){var n=(0,k.isArray)(e.value);t&&n&&!e.dontIterate||r.push({value:e.value,arrayIndices:e.arrayIndices}),n&&!e.dontIterate&&(0,b["default"])(e.value,function(t,n){r.push({value:t,arrayIndices:(e.arrayIndices||[]).concat(n)})})}),r}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.ELEMENT_OPERATORS=r.DocumentMatcher=void 0;var f="function"==typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":c(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":c(e);
},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.regexpElementMatcher=i,r.equalityElementMatcher=u,r.makeLookupFunction=s,r.expandArraysInBranches=a;var d=e("check-types"),h=n(d),p=e("fast.js/forEach"),b=n(p),v=e("fast.js/object/keys"),y=n(v),m=e("fast.js/map"),_=n(m),g=e("fast.js/array/some"),O=n(g),j=e("fast.js/array/every"),w=n(j),S=e("fast.js/array/indexOf"),E=n(S),P=e("geojson-utils"),x=n(P),A=e("./EJSON"),I=n(A),k=e("./Document"),M=r.DocumentMatcher=function(){function e(t){o(this,e),this._paths={},this._hasGeoQuery=!1,this._hasWhere=!1,this._isSimple=!0,this._matchingDocument=void 0,this._selector=null,this._docMatcher=this._compileSelector(t)}return l(e,[{key:"documentMatches",value:function(e){if(!e||"object"!==("undefined"==typeof e?"undefined":f(e)))throw Error("documentMatches needs a document");return this._docMatcher(e)}},{key:"_compileSelector",value:function(e){if(e instanceof Function)return this._isSimple=!1,this._selector=e,this._recordPathUsed(""),function(t){return{result:!!e.call(t)}};if((0,k.selectorIsId)(e))return this._selector={_id:e},this._recordPathUsed("_id"),function(t){return{result:I["default"].equals(t._id,e)}};if(!e||"_id"in e&&!e._id)return this._isSimple=!1,J;if("boolean"==typeof e||(0,k.isArray)(e)||I["default"].isBinary(e))throw new Error("Invalid selector: "+e);return this._selector=I["default"].clone(e),N(e,this,{isRoot:!0})}},{key:"_recordPathUsed",value:function(e){this._paths[e]=!0}},{key:"_getPaths",value:function(){return h["default"].object(this._paths)?(0,y["default"])(this._paths):null}},{key:"hasGeoQuery",get:function(){return this._hasGeoQuery}},{key:"hasWhere",get:function(){return this._hasWhere}},{key:"isSimple",get:function(){return this._isSimple}}]),e}();r["default"]=M;var N=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=[];return(0,b["default"])(e,function(e,o){if("$"===o.substr(0,1)){if(!$.hasOwnProperty(o))throw new Error("Unrecognized logical operator: "+o);t._isSimple=!1,n.push($[o](e,t,r.inElemMatch))}else{r.inElemMatch||t._recordPathUsed(o);var i=s(o),u=T(e,t,r.isRoot);n.push(function(e){var t=i(e);return u(t)})}}),Y(n)},T=function(e,t,r){return e instanceof RegExp?(t._isSimple=!1,C(i(e))):(0,k.isOperatorObject)(e)?R(e,t,r):C(u(e))},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(r){var n=r;t.dontExpandLeafArrays||(n=a(r,t.dontIncludeLeafArrays));var o={};return o.result=(0,O["default"])(n,function(t){var r=e(t.value);return"number"==typeof r&&(t.arrayIndices||(t.arrayIndices=[r]),r=!0),r&&t.arrayIndices&&(o.arrayIndices=t.arrayIndices),r}),o}},R=function(e,t,r){var n=[];return(0,b["default"])(e,function(o,i){var u=(0,E["default"])(["$lt","$lte","$gt","$gte"],i)>=0&&h["default"].number(o),s="$ne"===i&&!h["default"].object(o),a=(0,E["default"])(["$in","$nin"],i)>=0&&h["default"].array(o)&&!(0,O["default"])(o,h["default"].object);if("$eq"===i||u||a||s||(t._isSimple=!1),B.hasOwnProperty(i))n.push(B[i](o,e,t,r));else{if(!V.hasOwnProperty(i))throw new Error("Unrecognized operator: "+i);var c=V[i];n.push(C(c.compileElementSelector(o,e,t),c))}}),Q(n)},D=function(e,t,r){if(!(0,k.isArray)(e)||h["default"].emptyArray(e))throw Error("$and/$or/$nor must be nonempty array");return(0,_["default"])(e,function(e){if(!(0,k.isPlainObject)(e))throw Error("$or/$and/$nor entries need to be full objects");return N(e,t,{inElemMatch:r})})},$={$and:function(e,t,r){var n=D(e,t,r);return Y(n)},$or:function(e,t,r){var n=D(e,t,r);return 1===n.length?n[0]:function(e){var t=(0,O["default"])(n,function(t){return t(e).result});return{result:t}}},$nor:function(e,t,r){var n=D(e,t,r);return function(e){var t=(0,w["default"])(n,function(t){return!t(e).result});return{result:t}}},$where:function(e,t){return t._recordPathUsed(""),t._hasWhere=!0,e instanceof Function||(e=Function("obj","return "+e)),function(t){return{result:e.call(t,t)}}},$comment:function(){return function(){return{result:!0}}}},F=function(e){return function(t){var r=e(t);return{result:!r.result}}},B={$not:function(e,t,r){return F(T(e,r))},$ne:function(e){return F(C(u(e)))},$nin:function(e){return F(C(V.$in.compileElementSelector(e)))},$exists:function(e){var t=C(function(e){return void 0!==e});return e?t:F(t)},$options:function(e,t){if(!h["default"].object(t)||!t.hasOwnProperty("$regex"))throw Error("$options needs a $regex");return z},$maxDistance:function(e,t){if(!t.$near)throw Error("$maxDistance needs a $near");return z},$all:function(e,t,r){if(!(0,k.isArray)(e))throw Error("$all requires array");if(h["default"].emptyArray(e))return J;var n=[];return(0,b["default"])(e,function(e){if((0,k.isOperatorObject)(e))throw Error("no $ expressions in $all");n.push(T(e,r))}),Q(n)},$near:function(e,t,r,n){if(!n)throw Error("$near can't be inside another $ operator");r._hasGeoQuery=!0;var o,i,u;if((0,k.isPlainObject)(e)&&e.hasOwnProperty("$geometry"))o=e.$maxDistance,i=e.$geometry,u=function(e){return e&&e.type?"Point"===e.type?x["default"].pointDistance(i,e):x["default"].geometryWithinRadius(e,i,o)?0:o+1:null};else{if(o=t.$maxDistance,!(0,k.isArray)(e)&&!(0,k.isPlainObject)(e))throw Error("$near argument must be coordinate pair or GeoJSON");i=U(e),u=function(e){return(0,k.isArray)(e)||(0,k.isPlainObject)(e)?q(i,e):null}}return function(e){e=a(e);var t={result:!1};return(0,b["default"])(e,function(e){var r=u(e.value);null===r||r>o||void 0!==t.distance&&t.distance<=r||(t.result=!0,t.distance=r,e.arrayIndices?t.arrayIndices=e.arrayIndices:delete t.arrayIndices)}),t}}},q=function(e,t){e=U(e),t=U(t);var r=e[0]-t[0],n=e[1]-t[1];return h["default"].number(r)&&h["default"].number(n)?Math.sqrt(r*r+n*n):null},U=function(e){return(0,_["default"])(e,function(e){return e})},L=function(e){return{compileElementSelector:function(t){if((0,k.isArray)(t))return function(){return!1};void 0===t&&(t=null);var r=k.MongoTypeComp._type(t);return function(n){return void 0===n&&(n=null),k.MongoTypeComp._type(n)===r&&e(k.MongoTypeComp._cmp(n,t))}}}},V=r.ELEMENT_OPERATORS={$lt:L(function(e){return e<0}),$gt:L(function(e){return e>0}),$lte:L(function(e){return e<=0}),$gte:L(function(e){return e>=0}),$mod:{compileElementSelector:function(e){if(!(0,k.isArray)(e)||2!==e.length||"number"!=typeof e[0]||"number"!=typeof e[1])throw Error("argument to $mod must be an array of two numbers");var t=e[0],r=e[1];return function(e){return"number"==typeof e&&e%t===r}}},$in:{compileElementSelector:function(e){if(!(0,k.isArray)(e))throw Error("$in needs an array");var t=[];return(0,b["default"])(e,function(e){if(e instanceof RegExp)t.push(i(e));else{if((0,k.isOperatorObject)(e))throw Error("cannot nest $ under $in");t.push(u(e))}}),function(e){return void 0===e&&(e=null),(0,O["default"])(t,function(t){return t(e)})}}},$size:{dontExpandLeafArrays:!0,compileElementSelector:function(e){if("string"==typeof e)e=0;else if("number"!=typeof e)throw Error("$size needs a number");return function(t){return(0,k.isArray)(t)&&t.length===e}}},$type:{dontIncludeLeafArrays:!0,compileElementSelector:function(e){if("number"!=typeof e)throw Error("$type needs a number");return function(t){return void 0!==t&&k.MongoTypeComp._type(t)===e}}},$regex:{compileElementSelector:function(e,t){if(!("string"==typeof e||e instanceof RegExp))throw Error("$regex has to be a string or RegExp");var r;if(void 0!==t.$options){if(/[^gim]/.test(t.$options))throw new Error("Only the i, m, and g regexp options are supported");var n=e instanceof RegExp?e.source:e;r=new RegExp(n,t.$options)}else r=e instanceof RegExp?e:new RegExp(e);return i(r)}},$elemMatch:{dontExpandLeafArrays:!0,compileElementSelector:function(e,t,r){if(!(0,k.isPlainObject)(e))throw Error("$elemMatch need an object");var n,o;return(0,k.isOperatorObject)(e,!0)?(n=T(e,r),o=!1):(n=N(e,r,{inElemMatch:!0}),o=!0),function(e){if(!(0,k.isArray)(e))return!1;for(var t=0;t<e.length;++t){var r,i=e[t];if(o){if(!(0,k.isPlainObject)(i)&&!(0,k.isArray)(i))return!1;r=i}else r=[{value:i,dontIterate:!0}];if(n(r).result)return t}return!1}}}},J=function(e){return{result:!1}},z=function(e){return{result:!0}},W=function(e){return 0===e.length?z:1===e.length?e[0]:function(t){var r={};return r.result=(0,w["default"])(e,function(e){var n=e(t);return n.result&&void 0!==n.distance&&void 0===r.distance&&(r.distance=n.distance),n.result&&n.arrayIndices&&(r.arrayIndices=n.arrayIndices),n.result}),r.result||(delete r.distance,delete r.arrayIndices),r}},Y=W,Q=W},{"./Document":8,"./EJSON":14,"check-types":33,"fast.js/array/every":36,"fast.js/array/indexOf":39,"fast.js/array/some":42,"fast.js/forEach":43,"fast.js/map":50,"fast.js/object/keys":53,"geojson-utils":56}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.findModTarget=r.DocumentModifier=void 0;var u="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":i(e)},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("check-types"),c=n(a),f=e("fast.js/object/assign"),l=n(f),d=e("fast.js/forEach"),h=n(d),p=e("fast.js/array/every"),b=n(p),v=e("./EJSON"),y=n(v),m=e("./Random"),_=n(m),g=e("./DocumentMatcher"),O=n(g),j=e("./DocumentSorter"),w=n(j),S=e("./Document"),E=r.DocumentModifier=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._query=t,this._matcher=new O["default"](t)}return s(e,[{key:"modify",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[],i=[];if((0,h["default"])(e,function(e){var u=t._matcher.documentMatches(e);if(u.result){var s=(0,l["default"])({arrayIndices:u.arrayIndices},n),a=t._modifyDocument(e,r,s);i.push(a),o.push(e)}}),!i.length&&n.upsert){var u=P(this._query);u._id=u._id||_["default"]["default"]().id(17),u=this._modifyDocument(u,r,{isInsert:!0}),i.push(u),o.push(null)}return{updated:i,original:o}}},{key:"_modifyDocument",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(0,S.isPlainObject)(t))throw new Error("Modifier must be an object");t=y["default"].clone(t);var n,o=(0,S.isOperatorObject)(t);if(o)n=y["default"].clone(e),(0,h["default"])(t,function(e,t){var o=I[t];if(r.isInsert&&"$setOnInsert"===t&&(o=I.$set),!o)throw new Error("Invalid modifier specified "+t);(0,h["default"])(e,function(e,i){if(""===i)throw new Error("An empty update path is not valid.");if("_id"===i&&!r.isInsert)throw new Error("Mod on _id not allowed for update.");var u=i.split(".");if(!(0,b["default"])(u,function(e){return e}))throw new Error("The update path '"+i+"' contains an empty field name, which is not allowed.");var s=x(n,u,{noCreate:A[t],forbidArray:"$rename"===t,arrayIndices:r.arrayIndices}),a=u.pop();o(s,a,e,i,n)})});else{if(!r.isInsert&&t._id&&!y["default"].equals(e._id,t._id))throw new Error("Cannot change the _id of a document");for(var i in t)if(/\./.test(i))throw new Error("When replacing document, field name may not contain '.'");n=t,n._id=e._id}return n}}]),e}();r["default"]=E;var P=function(e){var t={};return c["default"].object(e)||(e={_id:e}),(0,h["default"])(e,function(e,r){if("$"!==r.substr(0,1)&&!(0,S.isOperatorObject)(e,!0)){var n=r.split("."),o=x(t,n);o&&(o[n[n.length-1]]=e)}}),t},x=r.findModTarget=function(e,t,r){r=r||{};for(var n=!1,o=0;o<t.length;o++){var i=o===t.length-1,s=t[o],a=(0,S.isIndexable)(e);if(!a){if(r.noCreate)return;var c=new Error("cannot use the part '"+s+"' to traverse "+e);throw c.setPropertyError=!0,c}if(e instanceof Array){if(r.forbidArray)return null;if("$"===s){if(n)throw new Error("Too many positional (i.e. '$') elements");if(!r.arrayIndices||!r.arrayIndices.length)throw new Error("The positional operator did not find the match needed from the query");s=r.arrayIndices[0],n=!0}else{if(!(0,S.isNumericKey)(s)){if(r.noCreate)return;throw new Error("can't append to array using string field name ["+s+"]")}s=parseInt(s,10)}if(i&&(t[o]=s),r.noCreate&&s>=e.length)return;for(;e.length<s;)e.push(null);if(!i)if(e.length===s)e.push({});else if("object"!==u(e[s]))throw new Error("can't modify field '"+t[o+1]+"' of list value "+JSON.stringify(e[s]))}else{if(s.length&&"$"===s.substr(0,1))throw new Error("can't set field named "+s);if(!(s in e)){if(r.noCreate)return;i||(e[s]={})}}if(i)return e;e=e[s]}},A={$unset:!0,$pop:!0,$rename:!0,$pull:!0,$pullAll:!0},I={$inc:function(e,t,r){if("number"!=typeof r)throw new Error("Modifier $inc allowed for numbers only");if(t in e){if("number"!=typeof e[t])throw new Error("Cannot apply $inc modifier to non-number");e[t]+=r}else e[t]=r},$set:function(e,t,r){if(!c["default"].object(e)&&!c["default"].array(e)){var n=new Error("Cannot set property on non-object field");throw n.setPropertyError=!0,n}if(null===e){var o=new Error("Cannot set property on null");throw o.setPropertyError=!0,o}e[t]=r},$setOnInsert:function(e,t,r){},$unset:function(e,t,r){void 0!==e&&(e instanceof Array?t in e&&(e[t]=null):delete e[t])},$push:function(e,t,r){if(void 0===e[t]&&(e[t]=[]),!(e[t]instanceof Array))throw new Error("Cannot apply $push modifier to non-array");if(!r||!r.$each)return void e[t].push(r);var n=r.$each;if(!(n instanceof Array))throw new Error("$each must be an array");var o=void 0;if("$position"in r){if("number"!=typeof r.$position)throw new Error("$position must be a numeric value");if(r.$position<0)throw new Error("$position in $push must be zero or positive");o=r.$position}var i=void 0;if("$slice"in r){if("number"!=typeof r.$slice)throw new Error("$slice must be a numeric value");if(r.$slice>0)throw new Error("$slice in $push must be zero or negative");i=r.$slice}var u=void 0;if(r.$sort){if(void 0===i)throw new Error("$sort requires $slice to be present");u=new w["default"](r.$sort).getComparator();for(var s=0;s<n.length;s++)if(3!==S.MongoTypeComp._type(n[s]))throw new Error("$push like modifiers using $sort require all elements to be objects")}if(void 0===o)for(var a=0;a<n.length;a++)e[t].push(n[a]);else{for(var c=[o,0],f=0;f<n.length;f++)c.push(n[f]);Array.prototype.splice.apply(e[t],c)}u&&e[t].sort(u),void 0!==i&&(0===i?e[t]=[]:e[t]=e[t].slice(i))},$pushAll:function(e,t,r){if(!("object"===("undefined"==typeof r?"undefined":u(r))&&r instanceof Array))throw new Error("Modifier $pushAll/pullAll allowed for arrays only");var n=e[t];if(void 0===n)e[t]=r;else{if(!(n instanceof Array))throw new Error("Cannot apply $pushAll modifier to non-array");for(var o=0;o<r.length;o++)n.push(r[o])}},$addToSet:function(e,t,r){var n=!1;if("object"===("undefined"==typeof r?"undefined":u(r)))for(var o in r){"$each"===o&&(n=!0);break}var i=n?r.$each:[r],s=e[t];if(void 0===s)e[t]=i;else{if(!(s instanceof Array))throw new Error("Cannot apply $addToSet modifier to non-array");(0,h["default"])(i,function(e){for(var t=0;t<s.length;t++)if(S.MongoTypeComp._equal(e,s[t]))return;s.push(e)})}},$pop:function(e,t,r){if(void 0!==e){var n=e[t];if(void 0!==n){if(!(n instanceof Array))throw new Error("Cannot apply $pop modifier to non-array");"number"==typeof r&&r<0?n.splice(0,1):n.pop()}}},$pull:function(e,t,r){if(void 0!==e){var n=e[t];if(void 0!==n){if(!(n instanceof Array))throw new Error("Cannot apply $pull/pullAll modifier to non-array");var o=[];if(null==r||"object"!==("undefined"==typeof r?"undefined":u(r))||r instanceof Array)for(var i=0;i<n.length;i++)S.MongoTypeComp._equal(n[i],r)||o.push(n[i]);else for(var s=new O["default"](r),a=0;a<n.length;a++)s.documentMatches(n[a]).result||o.push(n[a]);e[t]=o}}},$pullAll:function(e,t,r){if(!("object"===("undefined"==typeof r?"undefined":u(r))&&r instanceof Array))throw new Error("Modifier $pushAll/pullAll allowed for arrays only");if(void 0!==e){var n=e[t];if(void 0!==n){if(!(n instanceof Array))throw new Error("Cannot apply $pull/pullAll modifier to non-array");for(var o=[],i=0;i<n.length;i++){for(var s=!1,a=0;a<r.length;a++)if(S.MongoTypeComp._equal(n[i],r[a])){s=!0;break}s||o.push(n[i])}e[t]=o}}},$rename:function(e,t,r,n,o){if(n===r)throw new Error("$rename source must differ from target");if(null===e)throw new Error("$rename source field invalid");if("string"!=typeof r)throw new Error("$rename target must be a string");if(void 0!==e){var i=e[t];delete e[t];var u=r.split("."),s=x(o,u,{forbidArray:!0});if(null===s)throw new Error("$rename target field invalid");var a=u.pop();s[a]=i}},$bit:function(e,t,r){throw new Error("$bit is not supported")}}},{"./Document":8,"./DocumentMatcher":9,"./DocumentSorter":13,"./EJSON":14,"./Random":18,"check-types":33,"fast.js/array/every":36,"fast.js/forEach":43,"fast.js/object/assign":51}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return y["default"].object(e)&&e.hasOwnProperty(t)}function u(e){s(e);var t=void 0===e._id||e._id,r=a(e),n=function o(e,t){if(y["default"].array(e))return(0,I["default"])(e,function(e){return o(e,t)});var n=r.including?{}:T["default"].clone(e);return(0,_["default"])(t,function(t,u){i(e,u)&&(y["default"].object(t)?(y["default"].object(e[u])||y["default"].array(e[u]))&&(n[u]=o(e[u],t)):r.including?n[u]=T["default"].clone(e[u]):delete n[u])}),n};return function(e){var o=n(e,r.tree);return t&&i(e,"_id")&&(o._id=e._id),!t&&i(o,"_id")&&delete o._id,o}}function s(e){if(!y["default"].object(e)||y["default"].array(e))throw Error("fields option must be an object");(0,_["default"])(e,function(e,t){var r=y["default"].object(e)&&(0,O["default"])(e)||[];if((0,M["default"])(t.split("."),"$")>=0)throw Error("Minimongo doesn't support $ operator in projections yet.");if("object"===("undefined"==typeof e?"undefined":p(e))&&((0,M["default"])(r,"$elemMatch")>=0||(0,M["default"])(r,"$meta")>=0||(0,M["default"])(r,"$slice")>=0))throw Error("Minimongo doesn't support operators in projections yet.");if((0,M["default"])([1,0,!0,!1],e)===-1)throw Error("Projection values should be one of 1, 0, true, or false")})}function a(e){var t=(0,O["default"])(e).sort();!(t.length>0)||1===t.length&&"_id"===t[0]||(0,M["default"])(t,"_id")>=0&&e._id||(t=(0,x["default"])(t,function(e){return"_id"!==e}));var r=null;(0,_["default"])(t,function(t){var n=!!e[t];if(null===r&&(r=n),r!==n)throw Error("You cannot currently mix including and excluding fields.")});var n=c(t,function(e){return r},function(e,t,r){var n=r,o=t;throw Error("both "+n+" and "+o+" found in fields option, using both of them may trigger unexpected behavior. Did you mean to use only one of them?")});return{tree:n,including:r}}function c(e,t,r,n){return n=n||{},(0,_["default"])(e,function(e){var o=n,u=e.split("."),s=(0,E["default"])(u.slice(0,-1),function(t,n){if(i(o,t)){if(!y["default"].object(o[t])&&(o[t]=r(o[t],u.slice(0,n+1).join("."),e),!y["default"].object(o[t])))return!1}else o[t]={};return o=o[t],!0});if(s){var a=u[u.length-1];i(o,a)?o[a]=r(o[a],e,e):o[a]=t(e)}}),n}function f(e,t){var r=a(t),n=r.tree,o={};if(n=c(e,function(e){return!0},function(e,t,r){return!0},n),o=$(n),r.including)return o;var i={};return(0,_["default"])(o,function(e,t){e||(i[t]=!1)}),i}function l(e,t){var r=D(e._getPaths());return(0,M["default"])(r,"")>=0?{}:f(r,t)}function d(e,t){var r=D(e._getPaths());return f(r,t)}var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var p="function"==typeof Symbol&&"symbol"===h(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":h(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":h(e)},b=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.compileProjection=u,r.checkSupportedProjection=s,r.projectionDetails=a,r.pathsToTree=c,r.combineImportantPathsIntoProjection=f,r.combineMatcherWithProjection=l,r.combineSorterWithProjection=d;var v=e("check-types"),y=n(v),m=e("fast.js/forEach"),_=n(m),g=e("fast.js/object/keys"),O=n(g),j=e("fast.js/object/assign"),w=n(j),S=e("fast.js/array/every"),E=n(S),P=e("fast.js/array/filter"),x=n(P),A=e("fast.js/map"),I=n(A),k=e("fast.js/array/indexOf"),M=n(k),N=e("./EJSON"),T=n(N),C=e("./Document"),R=function(){function e(t){o(this,e),this.fields=t,this._projector=u(t)}return b(e,[{key:"project",value:function(e){var t=this;return y["default"].array(e)?(0,I["default"])(e,function(e){return t._projector(e)}):this._projector(e)}}]),e}();r["default"]=R;var D=function(e){return(0,I["default"])(e,function(e){return(0,x["default"])(e.split("."),function(e){return!(0,C.isNumericKey)(e)}).join(".")})},$=function F(e,t){t=t||"";var r={};return(0,_["default"])(e,function(e,n){y["default"].object(e)?(0,w["default"])(r,F(e,t+n+".")):r[t+n]=e}),r}},{"./Document":8,"./EJSON":14,"check-types":33,"fast.js/array/every":36,"fast.js/array/filter":37,"fast.js/array/indexOf":39,"fast.js/forEach":43,"fast.js/map":50,"fast.js/object/assign":51,"fast.js/object/keys":53}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.DocumentRetriver=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("check-types"),s=n(u),a=e("fast.js/map"),c=n(a),f=e("fast.js/array/filter"),l=n(f),d=e("./Document"),h=function(){return!0},p=r.DocumentRetriver=function(){function e(t){o(this,e),this.db=t}return i(e,[{key:"retriveForQeury",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0;return(0,d.selectorIsId)(e)?n=[e]:(0,d.selectorIsIdPerhapsAsObject)(e)?n=[e._id]:s["default"].object(e)&&e.hasOwnProperty("_id")&&s["default"].object(e._id)&&e._id.hasOwnProperty("$in")&&s["default"].array(e._id.$in)&&(n=e._id.$in),s["default"].array(n)&&n.length>0?this.retriveIds(t,n,r):this.retriveAll(t,r)}},{key:"retriveAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.limit||+(1/0),o=[],i=!1;return new Promise(function(r,u){var s=e.db.storage.createReadStream();s.then(function(u){for(var s=0;s<u.length;s++){var a=e.db.create(u[s]);o.length<n&&t(a)&&o.push(a)}r(o),i=!0})})}},{key:"retriveIds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(0,l["default"])(r,function(e,t){return r.indexOf(e)===t}),i=(0,c["default"])(o,function(e){return t.retriveOne(e)}),u=n.limit||+(1/0);return Promise.all(i).then(function(t){for(var r=[],n=0;n<t.length;n++){var o=t[n];if(o&&e(o)&&(r.push(o),r.length===u))break}return r})}},{key:"retriveOne",value:function(e){var t=this;return this.db.storage.get(e).then(function(e){return t.db.create(e)})}}]),e}();r["default"]=p},{"./Document":8,"check-types":33,"fast.js/array/filter":37,"fast.js/map":50}],13:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.DocumentSorter=void 0;var u="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":i(e)},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("check-types"),c=n(a),f=e("fast.js/forEach"),l=n(f),d=e("fast.js/array/every"),h=n(d),p=e("fast.js/map"),b=n(p),v=e("fast.js/array/indexOf"),y=n(v),m=e("fast.js/object/keys"),_=n(m),g=e("./DocumentMatcher"),O=n(g),j=e("./Document"),w=r.DocumentSorter=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this._sortSpecParts=[];var i=function(e,t){if(!e)throw Error("sort keys must be non-empty");if("$"===e.charAt(0))throw Error("unsupported sort key: "+e);r._sortSpecParts.push({path:e,lookup:(0,g.makeLookupFunction)(e,{forSort:!0}),ascending:t})};if(t instanceof Array)for(var s=0;s<t.length;s++)"string"==typeof t[s]?i(t[s],!0):i(t[s][0],"desc"!==t[s][1]);else{if("object"!==("undefined"==typeof t?"undefined":u(t)))throw Error("Bad sort specification: "+JSON.stringify(t));(0,l["default"])(t,function(e,t){i(t,e>=0)})}if(this.affectedByModifier){var a={};(0,l["default"])(this._sortSpecParts,function(e){a[e.path]=1}),this._selectorForAffectedByModifier=new O["default"](a)}this._keyComparator=S((0,b["default"])(this._sortSpecParts,function(e,t){return r._keyFieldComparator(t)})),this._keyFilter=null,n.matcher&&this._useWithMatcher(n.matcher)}return s(e,[{key:"getComparator",value:function(e){if(!e||!e.distances)return this._getBaseComparator();var t=e.distances;return S([this._getBaseComparator(),function(e,r){if(!t.has(e._id))throw Error("Missing distance for "+e._id);if(!t.has(r._id))throw Error("Missing distance for "+r._id);return t.get(e._id)-t.get(r._id)}])}},{key:"_getPaths",value:function(){return(0,b["default"])(this._sortSpecParts,function(e){return e.path})}},{key:"_getMinKeyFromDoc",value:function(e){var t=this,r=null;if(this._generateKeysFromDoc(e,function(e){if(t._keyCompatibleWithSelector(e))return null===r?void(r=e):void(t._compareKeys(e,r)<0&&(r=e))}),null===r)throw Error("sort selector found no keys in doc?");return r}},{key:"_keyCompatibleWithSelector",value:function(e){return!this._keyFilter||this._keyFilter(e)}},{key:"_generateKeysFromDoc",value:function(e,t){if(0===this._sortSpecParts.length)throw new Error("can't generate keys without a spec");var r=[],n=function(e){return e.join(",")+","},o=null;if((0,l["default"])(this._sortSpecParts,function(t,i){var u=(0,g.expandArraysInBranches)(t.lookup(e),!0);u.length||(u=[{value:null}]);var s=!1;if(r[i]={},(0,l["default"])(u,function(e){if(!e.arrayIndices){if(u.length>1)throw Error("multiple branches but no array used?");return void(r[i][""]=e.value)}s=!0;var t=n(e.arrayIndices);if(r[i].hasOwnProperty(t))throw Error("duplicate path: "+t);if(r[i][t]=e.value,o&&!o.hasOwnProperty(t))throw Error("cannot index parallel arrays")}),o){if(!r[i].hasOwnProperty("")&&(0,_["default"])(o).length!==(0,_["default"])(r[i]).length)throw Error("cannot index parallel arrays!")}else s&&(o={},(0,l["default"])(r[i],function(e,t){o[t]=!0}))}),!o){var i=(0,b["default"])(r,function(e){if(!e.hasOwnProperty(""))throw Error("no value in sole key case?");return e[""]});return void t(i)}(0,l["default"])(o,function(e,n){var o=(0,b["default"])(r,function(e){if(e.hasOwnProperty(""))return e[""];if(!e.hasOwnProperty(n))throw Error("missing path?");return e[n]});t(o)})}},{key:"_compareKeys",value:function(e,t){if(e.length!==this._sortSpecParts.length||t.length!==this._sortSpecParts.length)throw Error("Key has wrong length");return this._keyComparator(e,t)}},{key:"_keyFieldComparator",value:function(e){var t=!this._sortSpecParts[e].ascending;return function(r,n){var o=j.MongoTypeComp._cmp(r[e],n[e]);return t&&(o=-o),o}}},{key:"_getBaseComparator",value:function(){var e=this;return this._sortSpecParts.length?function(t,r){var n=e._getMinKeyFromDoc(t),o=e._getMinKeyFromDoc(r);return e._compareKeys(n,o)}:function(e,t){return 0}}},{key:"_useWithMatcher",value:function(e){if(this._keyFilter)throw Error("called _useWithMatcher twice?");if(!c["default"].emptyArray(this._sortSpecParts)){var t=e._selector;if(!(t instanceof Function)&&t){var r={};(0,l["default"])(this._sortSpecParts,function(e,t){r[e.path]=[]}),(0,l["default"])(t,function(e,t){var n=r[t];if(n){if(e instanceof RegExp){if(e.ignoreCase||e.multiline)return;return void n.push((0,g.regexpElementMatcher)(e))}return(0,j.isOperatorObject)(e)?void(0,l["default"])(e,function(t,r){(0,y["default"])(["$lt","$lte","$gt","$gte"],r)>=0&&n.push(g.ELEMENT_OPERATORS[r].compileElementSelector(t)),"$regex"!==r||e.$options||n.push(g.ELEMENT_OPERATORS.$regex.compileElementSelector(t,e))}):void n.push((0,g.equalityElementMatcher)(e))}});var n=r[this._sortSpecParts[0].path];c["default"].assigned(n)&&!c["default"].emptyArray(n)&&(this._keyFilter=function(e){return(0,h["default"])(this._sortSpecParts,function(t,n){return(0,h["default"])(r[t.path],function(t){return t(e[n])})})})}}}}]),e}();r["default"]=w;var S=function(e){return function(t,r){for(var n=0;n<e.length;++n){var o=e[n](t,r);if(0!==o)return o}return 0}}},{"./Document":8,"./DocumentMatcher":9,"check-types":33,"fast.js/array/every":36,"fast.js/array/indexOf":39,"fast.js/forEach":43,"fast.js/map":50,"fast.js/object/keys":53}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return"number"==typeof e&&e!=+e}function u(e,t){return y["default"].object(e)&&e.hasOwnProperty(t)}function s(e){return i(e)||e===1/0||e===-(1/0)}function a(e){return!!e&&"object"==("undefined"==typeof e?"undefined":l(e))&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.EJSON=void 0;var f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l="function"==typeof Symbol&&"symbol"===c(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":c(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":c(e)},d=e("./Base64"),h=n(d),p=e("fast.js/array/some"),b=n(p),v=e("check-types"),y=n(v),m=e("fast.js/object/keys"),_=n(m),g=e("fast.js/forEach"),O=n(g),j=r.EJSON=function(){function e(){o(this,e),this._setupBuiltinConverters(),
this._customTypes={}}return f(e,[{key:"addType",value:function(e,t){if(u(this._customTypes,e))throw new Error("Type "+e+" already present");this._customTypes[e]=t}},{key:"toJSONValue",value:function(e){var t=this._toJSONValueHelper(e);return void 0!==t?t:("object"===("undefined"==typeof e?"undefined":l(e))&&(e=this.clone(e),this._adjustTypesToJSONValue(e)),e)}},{key:"fromJSONValue",value:function(e){var t=this._fromJSONValueHelper(e);return t===e&&"object"===("undefined"==typeof e?"undefined":l(e))?(e=this.clone(e),this._adjustTypesFromJSONValue(e),e):t}},{key:"stringify",value:function(e){var t=this.toJSONValue(e);return JSON.stringify(t)}},{key:"parse",value:function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return this.fromJSONValue(JSON.parse(e))}},{key:"isBinary",value:function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)}},{key:"equals",value:function(e,t,r){var n,o=this,s=!(!r||!r.keyOrderSensitive);if(e===t)return!0;if(i(e)&&i(t))return!0;if(!e||!t)return!1;if("object"!==("undefined"==typeof e?"undefined":l(e))||"object"!==("undefined"==typeof t?"undefined":l(t)))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(this.isBinary(e)&&this.isBinary(t)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if("function"==typeof e.equals)return e.equals(t,r);if("function"==typeof t.equals)return t.equals(e,r);if(e instanceof Array){if(!(t instanceof Array))return!1;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!this.equals(e[n],t[n],r))return!1;return!0}switch(this._isCustomType(e)+this._isCustomType(t)){case 1:return!1;case 2:return this.equals(this.toJSONValue(e),this.toJSONValue(t))}var a;if(s){var c=(0,_["default"])(t);return n=0,a=(0,_["default"])(e).every(function(i){return!(n>=c.length)&&(i===c[n]&&(!!o.equals(e[i],t[c[n]],r)&&(n++,!0)))}),a&&n===c.length}return n=0,a=(0,_["default"])(e).every(function(i){return!!u(t,i)&&(!!o.equals(e[i],t[i],r)&&(n++,!0))}),a&&(0,_["default"])(t).length===n}},{key:"clone",value:function(e){var t,r=this;if("object"!==("undefined"==typeof e?"undefined":l(e)))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(this.isBinary(e)){t=h["default"].newBinary(e.length);for(var n=0;n<e.length;n++)t[n]=e[n];return t}if(y["default"].array(e)||a(e)){t=[];for(var o=0;o<e.length;o++)t[o]=this.clone(e[o]);return t}return"function"==typeof e.clone?e.clone():this._isCustomType(e)?this.fromJSONValue(this.clone(this.toJSONValue(e)),!0):(t={},(0,O["default"])(e,function(e,n){t[n]=r.clone(e)}),t)}},{key:"newBinary",value:function(e){return h["default"].newBinary(e)}},{key:"_setupBuiltinConverters",value:function(){var e=this;this._builtinConverters=[{matchJSONValue:function(e){return u(e,"$date")&&1===(0,_["default"])(e).length},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return u(e,"$InfNaN")&&1===(0,_["default"])(e).length},matchObject:s,toJSONValue:function(e){var t;return t=i(e)?0:e===1/0?1:-1,{$InfNaN:t}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return u(e,"$binary")&&1===(0,_["default"])(e).length},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&u(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:h["default"].encode(e)}},fromJSONValue:function(e){return h["default"].decode(e.$binary)}},{matchJSONValue:function(e){return u(e,"$escape")&&1===(0,_["default"])(e).length},matchObject:function(t){return!(!y["default"].assigned(t)||y["default"].emptyObject(t)||y["default"].object(t)&&(0,_["default"])(t).length>2)&&(0,b["default"])(e._builtinConverters,function(e){return e.matchJSONValue(t)})},toJSONValue:function(t){var r={};return(0,O["default"])(t,function(t,n){r[n]=e.toJSONValue(t)}),{$escape:r}},fromJSONValue:function(t){var r={};return(0,O["default"])(t.$escape,function(t,n){r[n]=e.fromJSONValue(t)}),r}},{matchJSONValue:function(e){return u(e,"$type")&&u(e,"$value")&&2===(0,_["default"])(e).length},matchObject:function(t){return e._isCustomType(t)},toJSONValue:function(e){var t=e.toJSONValue();return{$type:e.typeName(),$value:t}},fromJSONValue:function(t){var r=t.$type;if(!u(e._customTypes,r))throw new Error("Custom EJSON type "+r+" is not defined");var n=e._customTypes[r];return n(t.$value)}}]}},{key:"_isCustomType",value:function(e){return e&&"function"==typeof e.toJSONValue&&"function"==typeof e.typeName&&u(this._customTypes,e.typeName())}},{key:"_adjustTypesToJSONValue",value:function(e){var t=this;if(null===e)return null;var r=this._toJSONValueHelper(e);return void 0!==r?r:"object"!==("undefined"==typeof e?"undefined":l(e))?e:((0,O["default"])(e,function(r,n){if("object"===("undefined"==typeof r?"undefined":l(r))||void 0===r||s(r)){var o=t._toJSONValueHelper(r);return o?void(e[n]=o):void t._adjustTypesToJSONValue(r)}}),e)}},{key:"_toJSONValueHelper",value:function(e){for(var t=0;t<this._builtinConverters.length;t++){var r=this._builtinConverters[t];if(r.matchObject(e))return r.toJSONValue(e)}}},{key:"_adjustTypesFromJSONValue",value:function(e){var t=this;if(null===e)return null;var r=this._fromJSONValueHelper(e);return r!==e?r:"object"!==("undefined"==typeof e?"undefined":l(e))?e:((0,O["default"])(e,function(r,n){if("object"===("undefined"==typeof r?"undefined":l(r))){var o=t._fromJSONValueHelper(r);if(r!==o)return void(e[n]=o);t._adjustTypesFromJSONValue(r)}}),e)}},{key:"_fromJSONValueHelper",value:function(e){if("object"===("undefined"==typeof e?"undefined":l(e))&&null!==e&&(0,_["default"])(e).length<=2&&(0,_["default"])(e).every(function(e){return"string"==typeof e&&"$"===e.substr(0,1)}))for(var t=0;t<this._builtinConverters.length;t++){var r=this._builtinConverters[t];if(r.matchJSONValue(e))return r.fromJSONValue(e)}return e}}]),e}();r["default"]=new j},{"./Base64":2,"check-types":33,"fast.js/array/some":42,"fast.js/forEach":43,"fast.js/object/keys":53}],15:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.IndexManager=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("fast.js/function/bind"),s=n(u),a=e("fast.js/object/keys"),c=n(a),f=e("fast.js/forEach"),l=n(f),d=e("fast.js/map"),h=n(d),p=e("invariant"),b=n(p),v=e("./PromiseQueue"),y=n(v),m=e("./CollectionIndex"),_=n(m),g=e("./DocumentRetriver"),O=n(g),j=r.IndexManager=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.db=t,this.indexes={},this._queue=new y["default"](r.concurrency||2),this.ensureIndex({fieldName:"_id",unique:!0})}return i(e,[{key:"ensureIndex",value:function(e){(0,b["default"])(e&&e.fieldName,"You must specify a fieldName in options object");var t=e.fieldName;return this.indexes[t]?this.indexes[t].buildPromise?this.indexes[t].buildPromise:e&&e.forceRebuild?this.buildIndex(t):Promise.resolve():(this.indexes[t]=new _["default"](e),this.buildIndex(t))}},{key:"buildIndex",value:function(e){var t=this;(0,b["default"])(this.indexes[e],"Index with key `%s` does not ensured yet",e),console.log("buildIndex",e);var r=function(){t.indexes[e].buildPromise=null},n=this._queue.add((0,s["default"])(this._doBuildIndex,this,e)).then(r,r);return this.indexes[e].buildPromise=n,n}},{key:"buildAllIndexes",value:function(){var e=this;return Promise.all((0,h["default"])(this.indexes,function(t,r){return e.ensureIndex({fieldName:r,forceRebuild:!0})}))}},{key:"removeIndex",value:function(e){var t=this;return this._queue.add(function(){delete t.indexes[e]})}},{key:"indexDocument",value:function(e){var t=this;return this._queue.add(function(){var r=(0,c["default"])(t.indexes),n=null;try{(0,l["default"])(r,function(r,o){n=o,t.indexes[r].insert(e)})}catch(o){throw(0,l["default"])(r.slice(0,n),function(r){t.indexes[r].remove(e)}),o}})}},{key:"reindexDocument",value:function(e,t){var r=this;return this._queue.add(function(){var n=(0,c["default"])(r.indexes),o=null;try{(0,l["default"])(n,function(n,i){o=i,r.indexes[n].update(e,t)})}catch(i){throw(0,l["default"])(n.slice(0,o),function(n){r.indexes[n].revertUpdate(e,t)}),i}})}},{key:"deindexDocument",value:function(e){var t=this;return this._queue.add(function(){var r=(0,c["default"])(t.indexes);(0,l["default"])(r,function(r){t.indexes[r].remove(e)})})}},{key:"_doBuildIndex",value:function(e){var t=this.indexes[e];t.reset();var r=[];return new O["default"](this.db).retriveAll().then(function(e){if((0,l["default"])(e,function(e){try{t.insert(e)}catch(n){r.push([n,e])}}),r.length>0)throw new Error("Index build failed with errors: ",r)})}}]),e}();r["default"]=j},{"./CollectionIndex":5,"./DocumentRetriver":12,"./PromiseQueue":17,"fast.js/forEach":43,"fast.js/function/bind":46,"fast.js/map":50,"fast.js/object/keys":53,invariant:57}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":s(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function b(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:b(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},f=e("localforage"),l=n(f),d=e("./StorageManager"),h=n(d),p=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return u(t,e),a(t,[{key:"destroy",value:function(){var e=this;return this._queue.add(function(){return e.forage.clear().then(function(){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",e).call(e)})})}},{key:"persist",value:function(e,r){var n=this;return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"persist",this).call(this,e,r).then(function(){return n._queue.add(function(){return n.forage.setItem(e,r)})})}},{key:"delete",value:function(e){var r=this;return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this,e).then(function(){return r._queue.add(function(){return r.forage.removeItem(e)})})}},{key:"_loadStorage",value:function(){var e=this;return this.forage=this.forage||l["default"].createInstance({name:this.db.modelName}),this._queue.add(function(){return e.forage.iterate(function(t,r,n){e._storage[r]=t})})}}]),t}(h["default"]);r["default"]=p},{"./StorageManager":20,localforage:58}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("fast.js/function/try"),s=n(u),a=e("double-ended-queue"),c=n(a),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;o(this,e),this.pendingPromises=0,this.maxPendingPromises=t,this.maxQueuedPromises=r,this.queue=new c["default"],this.length=0}return i(e,[{key:"pause",value:function(){this._paused=!0}},{key:"unpause",value:function(){this._paused=!1,this._dequeue()}},{key:"add",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(n,o){if(t.length>=t.maxQueuedPromises)o(new Error("Queue limit reached"));else{var i={promiseGenerator:e,resolve:n,reject:o};r?t.queue.unshift(i):t.queue.push(i),t.length+=1,t._dequeue()}})}},{key:"_dequeue",value:function(){var e=this;if(this._paused||this.pendingPromises>=this.maxPendingPromises)return!1;var t=this.queue.shift();if(!t)return!1;var r=(0,s["default"])(function(){return e.pendingPromises++,Promise.resolve().then(function(){return t.promiseGenerator()}).then(function(r){e.length--,e.pendingPromises--,t.resolve(r),e._dequeue()},function(r){e.length--,e.pendingPromises--,t.reject(r),e._dequeue()})});return r instanceof Error&&(this.length--,this.pendingPromises--,t.reject(r),this._dequeue()),!0}}]),e}();r["default"]=f},{"double-ended-queue":34,"fast.js/function/try":49}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){var e="undefined"!=typeof window&&window.innerHeight||"undefined"!=typeof document&&document.documentElement&&document.documentElement.clientHeight||"undefined"!=typeof document&&document.body&&document.body.clientHeight||1,t="undefined"!=typeof window&&window.innerWidth||"undefined"!=typeof document&&document.documentElement&&document.documentElement.clientWidth||"undefined"!=typeof document&&document.body&&document.body.clientWidth||1,r="undefined"!=typeof navigator&&navigator.userAgent||"";return[new Date,e,t,r,Math.random()]}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r._getBrowserSeeds=i;var s=e("fast.js/function/try"),a=n(s),c=e("invariant"),f=n(c),l=void 0,d={NODE_CRYPTO:"NODE_CRYPTO",BROWSER_CRYPTO:"BROWSER_CRYPTO",ALEA:"ALEA"},h="23456789ABCDEFGHJKLMNPQRSTWXYZabcdefghijkmnopqrstuvwxyz",p="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_",b=function(){function e(){var e=4022871197,t=function(t){t=t.toString();for(var r=0;r<t.length;r++){e+=t.charCodeAt(r);var n=.02519603282416938*e;e=n>>>0,n-=e,n*=e,e=n>>>0,n-=e,e+=4294967296*n}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}return function(t){var r=0,n=0,o=0,i=1;0==t.length&&(t=[+new Date]);var u=e();r=u(" "),n=u(" "),o=u(" ");for(var s=0;s<t.length;s++)r-=u(t[s]),r<0&&(r+=1),n-=u(t[s]),n<0&&(n+=1),o-=u(t[s]),o<0&&(o+=1);u=null;var a=function(){var e=2091639*r+2.3283064365386963e-10*i;return r=n,n=o,o=e-(i=0|e)};return a.uint32=function(){return 4294967296*a()},a.fract53=function(){return a()+1.1102230246251565e-16*(2097152*a()|0)},a.version="Alea 0.9",a.args=t,a}(Array.prototype.slice.call(arguments))},v=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this.type=e,(0,f["default"])(d[e],"Random(...): no generator type %s",e),e===d.ALEA&&((0,f["default"])(r.seeds,"Random(...): seed is not provided for ALEA seeded generator"),this.alea=b.apply(null,r.seeds))}return u(t,[{key:"fraction",value:function(){if(this.type===d.ALEA)return this.alea();if(this.type===d.NODE_CRYPTO){var e=parseInt(this.hexString(8),16);return 2.3283064365386963e-10*e}if(this.type===d.BROWSER_CRYPTO){var t=new Uint32Array(1);return window.crypto.getRandomValues(t),2.3283064365386963e-10*t[0]}throw new Error("Unknown random generator type: "+this.type)}},{key:"hexString",value:function(t){if(this.type===d.NODE_CRYPTO){var r=e("crypto"),n=Math.ceil(t/2),o=(0,a["default"])(function(){return r.randomBytes(n)});o instanceof Error&&(o=r.pseudoRandomBytes(n));var i=o.toString("hex");return i.substring(0,t)}return this._randomString(t,"0123456789abcdef")}},{key:"_randomString",value:function(e,t){for(var r=[],n=0;n<e;n++)r[n]=this.choice(t);return r.join("")}},{key:"id",value:function(e){return void 0===e&&(e=17),this._randomString(e,h)}},{key:"secret",value:function(e){return void 0===e&&(e=43),this._randomString(e,p)}},{key:"choice",value:function(e){var t=Math.floor(this.fraction()*e.length);return"string"==typeof e?e.substr(t,1):e[t]}}],[{key:"default",value:function(){return l?l:"undefined"!=typeof window?window.crypto&&window.crypto.getRandomValues?new t(d.BROWSER_CRYPTO):new t(d.ALEA,{seeds:i()}):new t(d.NODE_CRYPTO)}},{key:"createWithSeeds",value:function(){return(0,f["default"])(arguments.length,"Random.createWithSeeds(...): no seeds were provided"),new t(d.ALEA,{seeds:arguments})}}]),t}();r["default"]=v},{crypto:void 0,"fast.js/function/try":49,invariant:57}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e){var t=i["default"]["default"]().hexString(20),r=[t,"/collection/"+e];return{value:i["default"].createWithSeeds.apply(null,r).id(17),seed:t}};var o=e("./Random"),i=n(o)},{"./Random":18}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.StorageManager=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("fast.js/object/keys"),s=n(u),a=e("eventemitter3"),c=(n(a),e("./PromiseQueue")),f=n(c),l=e("./EJSON"),d=n(l),h=(e("rxjs"),r.StorageManager=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.db=t,this.options=r,this._queue=new f["default"](1),this._storage={},this.reload()}return i(e,[{key:"loaded",value:function(){return this._loadedPromise}},{key:"reload",value:function(){var e=this;return this._loadedPromise?this._loadedPromise=this._loadedPromise.then(function(){return e._loadStorage()}):this._loadedPromise=this._loadStorage(),this.loaded()}},{key:"destroy",value:function(){var e=this;return this.loaded().then(function(){e._storage={}})}},{key:"persist",value:function(e,t){var r=this;return this.loaded().then(function(){r._storage[e]=d["default"].clone(t)})}},{key:"delete",value:function(e){var t=this;return this.loaded().then(function(){delete t._storage[e]})}},{key:"get",value:function(e){var t=this;return this.loaded().then(function(){return t._storage[e]})}},{key:"createReadStream",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("createReadStream",this.db._modelName);var t=!1;return new Promise(function(r,n){e.loaded().then(function(){for(var n=(0,s["default"])(e._storage),o=[],i=0;i<n.length;i++)if(o.push(e._storage[n[i]]),t)return;r(o)})})}},{key:"_loadStorage",value:function(){return this._storage={},Promise.resolve()}}]),e}());r["default"]=h},{"./EJSON":14,"./PromiseQueue":17,eventemitter3:35,"fast.js/object/keys":53,rxjs:60}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.aggregate=void 0;var o=e("invariant"),i=n(o);r.aggregate={method:function(e){return(0,i["default"])("function"==typeof e,"aggregate(...): aggregator must be a function"),this._addPipeline("aggregate",e),this},process:function(e,t){return t.value(e)}}},{invariant:57}],22:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.filter=void 0;var o=e("invariant"),i=n(o),u=e("fast.js/array/filter"),s=n(u);r.filter={method:function(e){return(0,i["default"])("function"==typeof e,"filter(...): argument must be a function"),this._addPipeline("filter",e),this},process:function(e,t){return(0,s["default"])(e,t.value)}}},{"fast.js/array/filter":37,invariant:57}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.ifNotEmpty=void 0;var o=e("check-types"),i=n(o);r.ifNotEmpty={method:function(){return this._addPipeline("ifNotEmpty"),this},process:function(e){var t=!i["default"].assigned(e)||i["default"].array(e)&&i["default"].emptyArray(e)||i["default"].object(e)&&i["default"].emptyObject(e);return t?"___[STOP]___":e}}},{"check-types":33}],24:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.join=void 0;var o=e("check-types"),i=n(o),u=e("invariant"),s=n(u),a=e("./joinObj"),c=e("./joinEach"),f=e("./joinAll");r.join={method:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s["default"])("function"==typeof e||i["default"].object(e),"join(...): argument must be a function"),this._addPipeline("join",e,t),this},process:function(e,t,r){return i["default"].object(t.value)?a.joinObj.process(e,t,r):i["default"].array(e)?c.joinEach.process(e,t,r):f.joinAll.process(e,t,r)}}},{"./joinAll":25,"./joinEach":26,"./joinObj":27,"check-types":33,invariant:57}],25:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.joinAll=void 0;var o=e("check-types"),i=n(o),u=e("fast.js/map"),s=n(u),a=e("fast.js/function/bind"),c=n(a),f=e("invariant"),l=n(f);r.joinAll={method:function(e){return(0,l["default"])("function"==typeof e,"joinAll(...): argument must be a function"),this._addPipeline("joinAll",e),this},process:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=r._propagateUpdate?(0,c["default"])(r._propagateUpdate,r):function(){},a=t.value(e,u,n,o);return a=i["default"].array(a)?a:[a],a=(0,s["default"])(a,function(e){var t=void 0;return e&&e.joinAll?t=e.exec():i["default"].object(e)&&e.cursor&&e.then&&(t=e),t&&r._trackChildCursorPromise(t),t||e}),Promise.all(a).then(function(){return e})}}},{"check-types":33,"fast.js/function/bind":46,"fast.js/map":50,invariant:57}],26:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.joinEach=void 0;var o=e("check-types"),i=n(o),u=e("fast.js/map"),s=n(u),a=e("invariant"),c=n(a),f=e("./joinAll");r.joinEach={method:function(e){return(0,c["default"])("function"==typeof e,"joinEach(...): argument must be a function"),this._addPipeline("joinEach",e),this},process:function(e,t,r){if(e){e=i["default"].array(e)?e:[e];var n=e.length;return Promise.all((0,s["default"])(e,function(e,o){return f.joinAll.process(e,t,r,o,n)}))}return Promise.resolve(e)}}},{"./joinAll":25,"check-types":33,"fast.js/map":50,invariant:57}],27:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){var r=(0,x.makeLookupFunction)(t),n=[],i=(0,p["default"])(e,function(e){var t=r(e),i=(0,v["default"])((0,m["default"])((0,p["default"])(t,function(e){return e.value}),function(e,t){return f["default"].array(t)?[].concat(o(e),o(t)):[].concat(o(e),[t])},[]),function(e){return(0,A.selectorIsId)(e)});return n=n.concat(i),{doc:e,lookupResult:t}});return{allIds:n,docsWrapped:i}}function u(e,t){if(t instanceof j["default"])return{model:t,joinPath:e};if(f["default"].object(t))return{model:t.model,joinPath:t.joinPath||e};throw new Error("Invalid join object value")}function s(e,t,r){var n={},o=e.split(".");(0,d["default"])(t,function(e){return n[e._id]=e}),(0,d["default"])(r,function(e){(0,d["default"])(e.lookupResult,function(t){if(t.value){var r=o.slice(),i=(0,P.findModTarget)(e.doc,r,{noCreate:!1,forbidArray:!1,arrayIndices:t.arrayIndices}),u=r[r.length-1];f["default"].array(t.value)?i[u]=(0,p["default"])(t.value,function(e){return n[e]}):i[u]=n[t.value]||null}})})}Object.defineProperty(r,"__esModule",{value:!0}),r.joinObj=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=e("check-types"),f=n(c),l=e("fast.js/forEach"),d=n(l),h=e("fast.js/map"),p=n(h),b=e("fast.js/array/filter"),v=n(b),y=e("fast.js/array/reduce"),m=n(y),_=e("fast.js/object/keys"),g=n(_),O=e("../Collection"),j=n(O),w=e("invariant"),S=n(w),E=e("./joinAll"),P=e("../DocumentModifier"),x=e("../DocumentMatcher"),A=e("../Document");r.joinObj={method:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,S["default"])(f["default"].object(e),"joinObj(...): argument must be an object"),this._addPipeline("joinObj",e,t),this},process:function(e,t,r){if(e){var n=t.value,o=t.args[0]||{},c=!f["default"].array(e);e=c?[e]:e;var l=function(t){return(0,p["default"])((0,g["default"])(n),function(t){var r=u(t,n[t]),a=r.model,c=r.joinPath,f=i(e,t),l=f.allIds,d=f.docsWrapped,h=o.observe?"observe":"then";return a.find({_id:{$in:l}})[h](function(e){s(c,e,d)})})},d=a({},t,{value:l});return E.joinAll.process(e,d,r).then(function(e){return c?e[0]:e})}return Promise.resolve(e)}}},{"../Collection":3,"../Document":8,"../DocumentMatcher":9,"../DocumentModifier":10,"./joinAll":25,"check-types":33,"fast.js/array/filter":37,"fast.js/array/reduce":41,"fast.js/forEach":43,"fast.js/map":50,"fast.js/object/keys":53,invariant:57}],28:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.map=void 0;var o=e("fast.js/map"),i=n(o),u=e("invariant"),s=n(u);r.map={method:function(e){return(0,s["default"])("function"==typeof e,"map(...): mapper must be a function"),this._addPipeline("map",e),this},process:function(e,t){return(0,i["default"])(e,t.value)}}},{"fast.js/map":50,invariant:57}],29:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.reduce=void 0;var o=e("fast.js/array/reduce"),i=n(o),u=e("invariant"),s=n(u);r.reduce={method:function(e,t){return(0,s["default"])("function"==typeof e,"reduce(...): reducer argument must be a function"),this._addPipeline("reduce",e,t),this},process:function(e,t){return(0,i["default"])(e,t.value,t.args[0])}}},{"fast.js/array/reduce":41,invariant:57}],30:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.sortFunc=void 0;var o=e("invariant"),i=n(o);r.sortFunc={method:function(e){return(0,i["default"])("function"==typeof e,"sortFunc(...): argument must be a function"),this._addPipeline("sortFunc",e),this},process:function(e,t){return e.sort(t.value)}}},{invariant:57}],31:[function(e,t,r){"use strict";function n(e,t,r){var n=null,o=0,i=null,u=!0,s=null,a=function(){var a=this,c=arguments;if(i){var f=r&&o>=r;if(u=!f,f&&s){var l=i;return l.debouncePassed=!0,clearTimeout(n),s(),o+=1,l}}else i=new Promise(function(r,f){(s=function(){u?(n=setTimeout(s,t),u=!1):(r(e.apply(a,c)),i=null,o=0,n=null,u=!0,s=null)})()});return o+=1,i},c=function(e){r=e},f=function(e){t=e},l=function(){clearTimeout(n)};return a.updateBatchSize=c,a.updateWait=f,a.cancel=l,a.func=e,a}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n},{}],32:[function(e,t,r){"use strict";var n=e("./dist/AsyncEventEmitter")["default"],o=e("./dist/Collection")["default"],i=e("./dist/CursorObservable")["default"],u=e("./dist/debounce")["default"],s=e("./dist/StorageManager")["default"],a=e("./dist/Random")["default"],c=e("./dist/EJSON")["default"],f=e("./dist/Base64")["default"],l=e("./dist/PromiseQueue")["default"],d=e("./dist/LocalForageManager")["default"];t.exports={__esModule:!0,"default":o,Random:a,EJSON:c,Base64:f,Collection:o,CursorObservable:i,StorageManager:s,EventEmitter:n,PromiseQueue:l,LocalForageManager:d,debounce:u}},{"./dist/AsyncEventEmitter":1,"./dist/Base64":2,"./dist/Collection":3,"./dist/CursorObservable":7,"./dist/EJSON":14,"./dist/LocalForageManager":16,"./dist/PromiseQueue":17,"./dist/Random":18,"./dist/StorageManager":20,"./dist/debounce":31}],33:[function(t,r,n){!function(t){"use strict";function n(e,t){return e===t}function o(e){return void 0===e}function i(e){return null===e}function u(e){return!o(e)&&!i(e)}function s(e){return 0===e}function a(e){return e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY}function c(e){return"number"==typeof e&&isNaN(e)===!1&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY}function f(e){return c(e)&&e%1===0}function l(e){return c(e)&&e%2===0}function d(e){return f(e)&&!l(e)}function h(e,t){return c(e)&&e>t}function p(e,t){return c(e)&&e<t}function b(e,t,r){return t<r?h(e,t)&&p(e,r):p(e,t)&&h(e,r)}function v(e,t){return c(e)&&e>=t}function y(e,t){return c(e)&&e<=t}function m(e,t,r){return t<r?v(e,t)&&y(e,r):y(e,t)&&v(e,r)}function _(e){return h(e,0)}function g(e){return p(e,0)}function O(e){return"string"==typeof e}function j(e){return""===e}function w(e){return O(e)&&""!==e}function S(e,t){return O(e)&&e.indexOf(t)!==-1}function E(e,t){return O(e)&&!!e.match(t)}function P(e){return e===!1||e===!0}function x(e){return"[object Object]"===Object.prototype.toString.call(e)}function A(e){return x(e)&&0===Object.keys(e).length}function I(e,t){try{return e instanceof t}catch(r){return!1}}function k(e,t){try{return I(e,t)||Object.prototype.toString.call(e)==="[object "+t.name+"]"}catch(r){return!1}}function M(e,t){try{return I(e,t)||e.constructor.name===t.name}catch(r){return!1}}function N(e,t){var r;for(r in t)if(t.hasOwnProperty(r)){if(e.hasOwnProperty(r)===!1||typeof e[r]!=typeof t[r])return!1;if(x(e[r])&&N(e[r],t[r])===!1)return!1}return!0}function T(e){return Array.isArray(e)}function C(e){return T(e)&&0===e.length}function R(e){return u(e)&&c(e.length)}function D(e){return"undefined"==typeof Symbol?R(e):u(e)&&q(e[Symbol.iterator])}function $(e,t){var r,n;if(ye.assigned(e))return!1;try{if("undefined"!=typeof Symbol&&e[Symbol.iterator]&&q(e.values)){r=e.values();do if(n=r.next(),n.value===t)return!0;while(!n.done);return!1}Object.keys(e).forEach(function(r){if(e[r]===t)throw 0})}catch(o){return!0}return!1}function F(e,t){return u(e)&&e.length===t}function B(e){return k(e,Date)&&!isNaN(e.getTime())}function q(e){return"function"==typeof e}function U(e,t){return ve.array(e),q(t)?e.map(function(e){return t(e)}):(ve.array(t),ve.hasLength(e,t.length),e.map(function(e,r){return t[r](e)}))}function L(e,t){return ve.object(e),q(t)?V(e,t):(ve.object(t),J(e,t))}function V(e,t){var r={};return Object.keys(e).forEach(function(n){r[n]=t(e[n])}),r}function J(e,t){var r={};return Object.keys(t).forEach(function(n){var o=t[n];q(o)?ye.assigned(e)?r[n]=!!o._isMaybefied:r[n]=o(e[n]):x(o)&&(r[n]=J(e[n],o))}),r}function z(e){return T(e)?W(e,!1):(ve.object(e),Y(e,!1))}function W(e,t){
var r;for(r=0;r<e.length;r+=1)if(e[r]===t)return t;return!t}function Y(e,t){var r,n;for(r in e)if(e.hasOwnProperty(r)){if(n=e[r],x(n)&&Y(n,t)===t)return t;if(n===t)return t}return!t}function Q(e){return T(e)?W(e,!0):(ve.object(e),Y(e,!0))}function G(e,t){return Object.keys(t).forEach(function(r){e[r]=t[r]}),e}function H(e,t){return function(){K(e,arguments,t)}}function K(e,t,r){var n=t[t.length-1];X(e.apply(null,t),w(n)?n:r)}function X(e,t){if(e===!1)throw new Error(t||"Assertion failed")}function Z(e){return function(){return ee(e.apply(null,arguments))}}function ee(e){return!e}function te(e){var t=function(){return!!ye.assigned(arguments[0])||e.apply(null,arguments)};return t._isMaybefied=!0,t}function re(e){return u(e)===!1||e}function ne(e,t,r){return function(){var n,o;if(n=arguments[0],"maybe"===e&&ye.assigned(n))return!0;if(!t(n))return!1;n=oe(t,n),o=ge.call(arguments,1);try{n.forEach(function(t){if(("maybe"!==e||u(t))&&!r.apply(null,[t].concat(o)))throw 0})}catch(i){return!1}return!0}}function oe(e,t){switch(e){case R:return ge.call(t);case x:return Object.keys(t).map(function(e){return t[e]});default:return t}}function ie(e,t){return ue([e,pe,t])}function ue(e){var t,r,n,o;return t=e.shift(),r=e.pop(),n=e.pop(),o=r||{},Object.keys(n).forEach(function(r){Object.defineProperty(o,r,{configurable:!1,enumerable:!0,writable:!1,value:t.apply(null,e.concat(n[r],he[r]))})}),o}function se(e,t){return ue([e,t,null])}function ae(e){pe[e].of=ue([ne.bind(null,null),pe[e],pe,null])}function ce(e,t){_e.forEach(function(r){e[r].of=se(t,pe[r].of)})}function fe(e){me[e].of=ue([ne.bind(null,"maybe"),pe[e],pe,null]),ve.maybe[e].of=se(H,me[e].of),ve.not[e].of=se(H,ye[e].of)}function le(n){"function"==typeof e&&e.amd?e(function(){return n}):"undefined"!=typeof r&&null!==r&&r.exports?r.exports=n:t.check=n}var de,he,pe,be,ve,ye,me,_e,ge;de={v:"value",n:"number",s:"string",b:"boolean",o:"object",t:"type",a:"array",al:"array-like",i:"iterable",d:"date",f:"function",l:"length"},he={},pe={},[{n:"equal",f:n,s:"v"},{n:"undefined",f:o,s:"v"},{n:"null",f:i,s:"v"},{n:"assigned",f:u,s:"v"},{n:"includes",f:$,s:"v"},{n:"zero",f:s,s:"n"},{n:"infinity",f:a,s:"n"},{n:"number",f:c,s:"n"},{n:"integer",f:f,s:"n"},{n:"even",f:l,s:"n"},{n:"odd",f:d,s:"n"},{n:"greater",f:h,s:"n"},{n:"less",f:p,s:"n"},{n:"between",f:b,s:"n"},{n:"greaterOrEqual",f:v,s:"n"},{n:"lessOrEqual",f:y,s:"n"},{n:"inRange",f:m,s:"n"},{n:"positive",f:_,s:"n"},{n:"negative",f:g,s:"n"},{n:"string",f:O,s:"s"},{n:"emptyString",f:j,s:"s"},{n:"nonEmptyString",f:w,s:"s"},{n:"contains",f:S,s:"s"},{n:"match",f:E,s:"s"},{n:"boolean",f:P,s:"b"},{n:"object",f:x,s:"o"},{n:"emptyObject",f:A,s:"o"},{n:"instance",f:I,s:"t"},{n:"builtIn",f:k,s:"t"},{n:"userDefined",f:M,s:"t"},{n:"like",f:N,s:"t"},{n:"array",f:T,s:"a"},{n:"emptyArray",f:C,s:"a"},{n:"arrayLike",f:R,s:"al"},{n:"iterable",f:D,s:"i"},{n:"date",f:B,s:"d"},{n:"function",f:q,s:"f"},{n:"hasLength",f:F,s:"l"}].map(function(e){he[e.n]="Invalid "+de[e.s],pe[e.n]=e.f}),be={apply:U,map:L,all:z,any:Q},_e=["array","arrayLike","iterable","object"],ge=Array.prototype.slice,be=G(be,pe),ve=ie(H,X),ye=ie(Z,ee),me=ie(te,re),ve.not=se(H,ye),ve.maybe=se(H,me),_e.forEach(ae),ce(ve,H),ce(ye,Z),_e.forEach(fe),le(G(be,{assert:ve,not:ye,maybe:me}))}(this)},{}],34:[function(e,t,r){"use strict";function n(e){if(this._capacity=u(e),this._length=0,this._front=0,this._makeCapacity(),s(e)){for(var t=e.length,r=0;r<t;++r)this[r]=e[r];this._length=t}}function o(e,t,r,n,o){for(var i=0;i<o;++i)r[i+n]=e[i+t]}function i(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}function u(e){if("number"!=typeof e){if(!s(e))return 16;e=e.length}return i(Math.min(Math.max(16,e),1073741824))}n.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,n=this._capacity,o=0;o<e;++o)t[o]=this[r+o&n-1];return t},n.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var n=this._capacity;if(r+t>n){for(var o=0;o<t;++o){this._checkCapacity(r+1);var i=this._front+r&this._capacity-1;this[i]=arguments[o],r++,this._length=r}return r}for(var i=this._front,o=0;o<t;++o)this[i+r&n-1]=arguments[o],i++;return this._length=r+t,r+t}if(0===t)return r;this._checkCapacity(r+1);var o=this._front+r&this._capacity-1;return this[o]=e,this._length=r+1,r+1},n.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}},n.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}},n.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){var n=this._capacity;if(t+r>n){for(var o=r-1;o>=0;o--){this._checkCapacity(t+1);var n=this._capacity,i=(this._front-1&n-1^n)-n;this[i]=arguments[o],t++,this._length=t,this._front=i}return t}for(var u=this._front,o=r-1;o>=0;o--){var i=(u-1&n-1^n)-n;this[i]=arguments[o],u=i}return this._front=u,this._length=t+r,t+r}if(0===r)return t;this._checkCapacity(t+1);var n=this._capacity,o=(this._front-1&n-1^n)-n;return this[o]=e,this._length=t+1,this._front=o,t+1},n.prototype.peekBack=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1;return this[t]}},n.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},n.prototype.get=function(e){var t=e;if(t===(0|t)){var r=this._length;if(t<0&&(t+=r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}},n.prototype.isEmpty=function(){return 0===this._length},n.prototype.clear=function(){this._length=0,this._front=0,this._makeCapacity()},n.prototype.toString=function(){return this.toArray().toString()},n.prototype.valueOf=n.prototype.toString,n.prototype.removeFront=n.prototype.shift,n.prototype.removeBack=n.prototype.pop,n.prototype.insertFront=n.prototype.unshift,n.prototype.insertBack=n.prototype.push,n.prototype.enqueue=n.prototype.push,n.prototype.dequeue=n.prototype.shift,n.prototype.toJSON=n.prototype.toArray,Object.defineProperty(n.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),n.prototype._makeCapacity=function(){for(var e=this._capacity,t=0;t<e;++t)this[t]=void 0},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(u(1.5*this._capacity+16))},n.prototype._resizeTo=function(e){var t=this._front,r=this._capacity,n=new Array(r),i=this._length;if(o(this,0,n,0,r),this._capacity=e,this._makeCapacity(),this._front=0,t+i<=r)o(n,t,this,0,i);else{var u=i-(t+i&r-1);o(n,t,this,0,u),o(n,0,this,u,i-u)}};var s=Array.isArray;t.exports=n},{}],35:[function(e,t,r){"use strict";function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(){}var i="function"!=typeof Object.create&&"~";o.prototype._events=void 0,o.prototype.listeners=function(e,t){var r=i?i+e:e,n=this._events&&this._events[r];if(t)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var o=0,u=n.length,s=new Array(u);o<u;o++)s[o]=n[o].fn;return s},o.prototype.emit=function(e,t,r,n,o,u){var s=i?i+e:e;if(!this._events||!this._events[s])return!1;var a,c,f=this._events[s],l=arguments.length;if("function"==typeof f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,r),!0;case 4:return f.fn.call(f.context,t,r,n),!0;case 5:return f.fn.call(f.context,t,r,n,o),!0;case 6:return f.fn.call(f.context,t,r,n,o,u),!0}for(c=1,a=new Array(l-1);c<l;c++)a[c-1]=arguments[c];f.fn.apply(f.context,a)}else{var d,h=f.length;for(c=0;c<h;c++)switch(f[c].once&&this.removeListener(e,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,t);break;case 3:f[c].fn.call(f[c].context,t,r);break;default:if(!a)for(d=1,a=new Array(l-1);d<l;d++)a[d-1]=arguments[d];f[c].fn.apply(f[c].context,a)}}return!0},o.prototype.on=function(e,t,r){var o=new n(t,r||this),u=i?i+e:e;return this._events||(this._events=i?{}:Object.create(null)),this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],o]:this._events[u].push(o):this._events[u]=o,this},o.prototype.once=function(e,t,r){var o=new n(t,r||this,(!0)),u=i?i+e:e;return this._events||(this._events=i?{}:Object.create(null)),this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],o]:this._events[u].push(o):this._events[u]=o,this},o.prototype.removeListener=function(e,t,r,n){var o=i?i+e:e;if(!this._events||!this._events[o])return this;var u=this._events[o],s=[];if(t)if(u.fn)(u.fn!==t||n&&!u.once||r&&u.context!==r)&&s.push(u);else for(var a=0,c=u.length;a<c;a++)(u[a].fn!==t||n&&!u[a].once||r&&u[a].context!==r)&&s.push(u[a]);return s.length?this._events[o]=1===s.length?s[0]:s:delete this._events[o],this},o.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[i?i+e:e]:this._events=i?{}:Object.create(null),this):this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=i,"undefined"!=typeof t&&(t.exports=o)},{}],36:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i=e.length,u=void 0!==r?n(t,r):t;for(o=0;o<i;o++)if(!u(e[o],o,e))return!1;return!0}},{"../function/bindInternal3":47}],37:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i=e.length,u=[],s=void 0!==r?n(t,r):t;for(o=0;o<i;o++)s(e[o],o,e)&&u.push(e[o]);return u}},{"../function/bindInternal3":47}],38:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i=e.length,u=void 0!==r?n(t,r):t;for(o=0;o<i;o++)u(e[o],o,e)}},{"../function/bindInternal3":47}],39:[function(e,t,r){"use strict";t.exports=function(e,t,r){var n=e.length,o=0;for("number"==typeof r&&(o=r,o<0&&(o+=n,o<0&&(o=0)));o<n;o++)if(e[o]===t)return o;return-1}},{}],40:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i=e.length,u=new Array(i),s=void 0!==r?n(t,r):t;for(o=0;o<i;o++)u[o]=s(e[o],o,e);return u}},{"../function/bindInternal3":47}],41:[function(e,t,r){"use strict";var n=e("../function/bindInternal4");t.exports=function(e,t,r,o){var i,u,s=e.length,a=void 0!==o?n(t,o):t;for(void 0===r?(i=1,u=e[0]):(i=0,u=r);i<s;i++)u=a(u,e[i],i,e);return u}},{"../function/bindInternal4":48}],42:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i=e.length,u=void 0!==r?n(t,r):t;for(o=0;o<i;o++)if(u(e[o],o,e))return!0;return!1}},{"../function/bindInternal3":47}],43:[function(e,t,r){"use strict";var n=e("./array/forEach"),o=e("./object/forEach");t.exports=function(e,t,r){return e instanceof Array?n(e,t,r):o(e,t,r)}},{"./array/forEach":38,"./object/forEach":52}],44:[function(e,t,r){"use strict";t.exports=function(e,t){switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);case 4:return e(t[0],t[1],t[2],t[3]);case 5:return e(t[0],t[1],t[2],t[3],t[4]);case 6:return e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);default:return e.apply(void 0,t)}}},{}],45:[function(e,t,r){"use strict";t.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2]);case 4:return e.call(t,r[0],r[1],r[2],r[3]);case 5:return e.call(t,r[0],r[1],r[2],r[3],r[4]);case 6:return e.call(t,r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return e.call(t,r[0],r[1],r[2],r[3],r[4],r[5],r[6]);case 8:return e.call(t,r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]);default:return e.apply(t,r)}}},{}],46:[function(e,t,r){"use strict";var n=e("./applyWithContext"),o=e("./applyNoContext");t.exports=function(e,t){var r,i=arguments.length-2;if(i>0){r=new Array(i);for(var u=0;u<i;u++)r[u]=arguments[u+2];return void 0!==t?function(){var o,u=arguments.length,s=new Array(i+u);for(o=0;o<i;o++)s[o]=r[o];for(o=0;o<u;o++)s[i+o]=arguments[o];return n(e,t,s)}:function(){var t,n=arguments.length,u=new Array(i+n);for(t=0;t<i;t++)u[t]=r[t];for(t=0;t<n;t++)u[i+t]=arguments[t];return o(e,u)}}return void 0!==t?function(){return n(e,t,arguments)}:function(){return o(e,arguments)}}},{"./applyNoContext":44,"./applyWithContext":45}],47:[function(e,t,r){"use strict";t.exports=function(e,t){return function(r,n,o){return e.call(t,r,n,o)}}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){return function(r,n,o,i){return e.call(t,r,n,o,i)}}},{}],49:[function(e,t,r){"use strict";t.exports=function(e){try{return e()}catch(t){return t instanceof Error?t:new Error(t)}}},{}],50:[function(e,t,r){"use strict";var n=e("./array/map"),o=e("./object/map");t.exports=function(e,t,r){return e instanceof Array?n(e,t,r):o(e,t,r)}},{"./array/map":40,"./object/map":54}],51:[function(e,t,r){"use strict";t.exports=function(e){var t,r,n,o,i,u,s=arguments.length;for(r=1;r<s;r++)for(t=arguments[r],o=Object.keys(t),n=o.length,u=0;u<n;u++)i=o[u],e[i]=t[i];return e}},{}],52:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i,u=Object.keys(e),s=u.length,a=void 0!==r?n(t,r):t;for(i=0;i<s;i++)o=u[i],a(e[o],o,e)}},{"../function/bindInternal3":47}],53:[function(e,t,r){"use strict";t.exports="function"==typeof Object.keys?Object.keys:function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],54:[function(e,t,r){"use strict";var n=e("../function/bindInternal3");t.exports=function(e,t,r){var o,i,u=Object.keys(e),s=u.length,a={},c=void 0!==r?n(t,r):t;for(o=0;o<s;o++)i=u[o],a[i]=c(e[i],i,e);return a}},{"../function/bindInternal3":47}],55:[function(e,t,r){"use strict";t.exports=function(e){for(var t=Object.keys(e),r=t.length,n=new Array(r),o=0;o<r;o++)n[o]=e[t[o]];return n}},{}],56:[function(e,t,r){!function(){function e(e){for(var t=[],r=[],n=0;n<e[0].length;n++)t.push(e[0][n][1]),r.push(e[0][n][0]);return t=t.sort(function(e,t){return e-t}),r=r.sort(function(e,t){return e-t}),[[t[0],r[0]],[t[t.length-1],r[r.length-1]]]}function r(e,t,r){for(var n=[[0,0]],o=0;o<r.length;o++){for(var i=0;i<r[o].length;i++)n.push(r[o][i]);n.push(r[o][0]),n.push([0,0])}for(var u=!1,o=0,i=n.length-1;o<n.length;i=o++)n[o][0]>t!=n[i][0]>t&&e<(n[i][1]-n[o][1])*(t-n[o][0])/(n[i][0]-n[o][0])+n[o][1]&&(u=!u);return u}var n=this.gju={};"undefined"!=typeof t&&t.exports&&(t.exports=n),n.lineStringsIntersect=function(e,t){for(var r=[],n=0;n<=e.coordinates.length-2;++n)for(var o=0;o<=t.coordinates.length-2;++o){var i={x:e.coordinates[n][1],y:e.coordinates[n][0]},u={x:e.coordinates[n+1][1],y:e.coordinates[n+1][0]},s={x:t.coordinates[o][1],y:t.coordinates[o][0]},a={x:t.coordinates[o+1][1],y:t.coordinates[o+1][0]},c=(a.x-s.x)*(i.y-s.y)-(a.y-s.y)*(i.x-s.x),f=(u.x-i.x)*(i.y-s.y)-(u.y-i.y)*(i.x-s.x),l=(a.y-s.y)*(u.x-i.x)-(a.x-s.x)*(u.y-i.y);if(0!=l){var d=c/l,h=f/l;0<=d&&d<=1&&0<=h&&h<=1&&r.push({type:"Point",coordinates:[i.x+d*(u.x-i.x),i.y+d*(u.y-i.y)]})}}return 0==r.length&&(r=!1),r},n.pointInBoundingBox=function(e,t){return!(e.coordinates[1]<t[0][0]||e.coordinates[1]>t[1][0]||e.coordinates[0]<t[0][1]||e.coordinates[0]>t[1][1])},n.pointInPolygon=function(t,o){for(var i="Polygon"==o.type?[o.coordinates]:o.coordinates,u=!1,s=0;s<i.length;s++)n.pointInBoundingBox(t,e(i[s]))&&(u=!0);if(!u)return!1;for(var a=!1,s=0;s<i.length;s++)r(t.coordinates[1],t.coordinates[0],i[s])&&(a=!0);return a},n.pointInMultiPolygon=function(t,o){for(var i="MultiPolygon"==o.type?[o.coordinates]:o.coordinates,u=!1,s=!1,a=0;a<i.length;a++){for(var c=i[a],f=0;f<c.length;f++)u||n.pointInBoundingBox(t,e(c[f]))&&(u=!0);if(!u)return!1;for(var f=0;f<c.length;f++)s||r(t.coordinates[1],t.coordinates[0],c[f])&&(s=!0)}return s},n.numberToRadius=function(e){return e*Math.PI/180},n.numberToDegree=function(e){return 180*e/Math.PI},n.drawCircle=function(e,t,r){for(var o=[t.coordinates[1],t.coordinates[0]],i=e/1e3/6371,u=[n.numberToRadius(o[0]),n.numberToRadius(o[1])],r=r||15,s=[[o[0],o[1]]],a=0;a<r;a++){var c=2*Math.PI*a/r,f=Math.asin(Math.sin(u[0])*Math.cos(i)+Math.cos(u[0])*Math.sin(i)*Math.cos(c)),l=u[1]+Math.atan2(Math.sin(c)*Math.sin(i)*Math.cos(u[0]),Math.cos(i)-Math.sin(u[0])*Math.sin(f));s[a]=[],s[a][1]=n.numberToDegree(f),s[a][0]=n.numberToDegree(l)}return{type:"Polygon",coordinates:[s]}},n.rectangleCentroid=function(e){var t=e.coordinates[0],r=t[0][0],n=t[0][1],o=t[2][0],i=t[2][1],u=o-r,s=i-n;return{type:"Point",coordinates:[r+u/2,n+s/2]}},n.pointDistance=function(e,t){var r=e.coordinates[0],o=e.coordinates[1],i=t.coordinates[0],u=t.coordinates[1],s=n.numberToRadius(u-o),a=n.numberToRadius(i-r),c=Math.pow(Math.sin(s/2),2)+Math.cos(n.numberToRadius(o))*Math.cos(n.numberToRadius(u))*Math.pow(Math.sin(a/2),2),f=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return 6371*f*1e3},n.geometryWithinRadius=function(e,t,r){if("Point"==e.type)return n.pointDistance(e,t)<=r;if("LineString"==e.type||"Polygon"==e.type){var o,i={};o="Polygon"==e.type?e.coordinates[0]:e.coordinates;for(var u in o)if(i.coordinates=o[u],n.pointDistance(i,t)>r)return!1}return!0},n.area=function(e){for(var t,r,n=0,o=e.coordinates[0],i=o.length-1,u=0;u<o.length;i=u++){var t={x:o[u][1],y:o[u][0]},r={x:o[i][1],y:o[i][0]};n+=t.x*r.y,n-=t.y*r.x}return n/=2},n.centroid=function(e){for(var t,r,o,i=0,u=0,s=e.coordinates[0],a=s.length-1,c=0;c<s.length;a=c++){var r={x:s[c][1],y:s[c][0]},o={x:s[a][1],y:s[a][0]};t=r.x*o.y-o.x*r.y,i+=(r.x+o.x)*t,u+=(r.y+o.y)*t}return t=6*n.area(e),{type:"Point",coordinates:[u/t,i/t]}},n.simplify=function(e,t){t=t||20,e=e.map(function(e){return{lng:e.coordinates[0],lat:e.coordinates[1]}});var r,n,o,i,u,s,a,c,f,l,d,h,p,b,v,y,m,_,g,O=Math.PI/180*.5,j=new Array,w=new Array,S=new Array;if(e.length<3)return e;for(r=e.length,l=360*t/(2*Math.PI*6378137),l*=l,o=0,w[0]=0,S[0]=r-1,n=1;n>0;)if(i=w[n-1],u=S[n-1],n--,u-i>1){for(d=e[u].lng()-e[i].lng(),h=e[u].lat()-e[i].lat(),Math.abs(d)>180&&(d=360-Math.abs(d)),d*=Math.cos(O*(e[u].lat()+e[i].lat())),p=d*d+h*h,s=i+1,a=i,f=-1;s<u;s++)b=e[s].lng()-e[i].lng(),v=e[s].lat()-e[i].lat(),Math.abs(b)>180&&(b=360-Math.abs(b)),b*=Math.cos(O*(e[s].lat()+e[i].lat())),y=b*b+v*v,m=e[s].lng()-e[u].lng(),_=e[s].lat()-e[u].lat(),Math.abs(m)>180&&(m=360-Math.abs(m)),m*=Math.cos(O*(e[s].lat()+e[u].lat())),g=m*m+_*_,c=y>=p+g?g:g>=p+y?y:(b*h-v*d)*(b*h-v*d)/p,c>f&&(a=s,f=c);f<l?(j[o]=i,o++):(n++,w[n-1]=a,S[n-1]=u,n++,w[n-1]=i,S[n-1]=a)}else j[o]=i,o++;j[o]=r-1,o++;for(var E=new Array,s=0;s<o;s++)E.push(e[j[s]]);return E.map(function(e){return{type:"Point",coordinates:[e.lng,e.lat]}})},n.destinationPoint=function(e,t,r){r/=6371,t=n.numberToRadius(t);var o=n.numberToRadius(e.coordinates[0]),i=n.numberToRadius(e.coordinates[1]),u=Math.asin(Math.sin(i)*Math.cos(r)+Math.cos(i)*Math.sin(r)*Math.cos(t)),s=o+Math.atan2(Math.sin(t)*Math.sin(r)*Math.cos(i),Math.cos(r)-Math.sin(i)*Math.sin(u));return s=(s+3*Math.PI)%(2*Math.PI)-Math.PI,{type:"Point",coordinates:[n.numberToDegree(s),n.numberToDegree(u)]}}}()},{}],57:[function(e,t,r){(function(e){"use strict";var r=function(t,r,n,o,i,u,s,a){if("production"!==e.env.NODE_ENV&&void 0===r)throw new Error("invariant requires an error message argument");if(!t){var c;if(void 0===r)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[n,o,i,u,s,a],l=0;c=new Error(r.replace(/%s/g,function(){return f[l++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}};t.exports=r}).call(this,e("_process"))},{_process:59}],58:[function(t,r,n){(function(o){!function(t){if("object"==typeof n&&"undefined"!=typeof r)r.exports=t();else if("function"==typeof e&&e.amd)e([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof o?o:"undefined"!=typeof self?self:this,i.localforage=t()}}(function(){return function e(r,n,o){function i(s,a){if(!n[s]){if(!r[s]){var c="function"==typeof t&&t;if(!a&&c)return c(s,!0);if(u)return u(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[s]={exports:{}};r[s][0].call(l.exports,function(e){var t=r[s][1][e];return i(t?t:e)},l,l.exports,e,r,n,o)}return n[s].exports}for(var u="function"==typeof t&&t,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(e,t,r){(function(e){"use strict";function r(){f=!0;for(var e,t,r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}f=!1}function n(e){1!==l.push(e)||f||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var u=0,s=new i(r),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),o=function(){a.data=u=++u%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)o="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){r(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(r,0)};else{var c=new e.MessageChannel;c.port1.onmessage=r,o=function(){c.port2.postMessage(0)}}var f,l=[];t.exports=n}).call(this,"undefined"!=typeof o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";function n(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,e!==n&&a(this,e)}function i(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function u(e,t,r){p(function(){var n;try{n=t(r)}catch(o){return b.reject(e,o)}n===e?b.reject(e,new TypeError("Cannot resolve promise with itself")):b.resolve(e,n)})}function s(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function a(e,t){function r(t){i||(i=!0,b.reject(e,t))}function n(t){i||(i=!0,b.resolve(e,t))}function o(){t(n,r)}var i=!1,u=c(o);"error"===u.status&&r(u.value)}function c(e,t){var r={};try{r.value=e(t),r.status="success"}catch(n){r.status="error",r.value=n}return r}function f(e){return e instanceof this?e:b.resolve(new this(n),e)}function l(e){var t=new this(n);return b.reject(t,e)}function d(e){function t(e,t){function n(e){u[t]=e,++s!==o||i||(i=!0,b.resolve(c,u))}r.resolve(e).then(n,function(e){i||(i=!0,b.reject(c,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var u=new Array(o),s=0,a=-1,c=new this(n);++a<o;)t(e[a],a);return c}function h(e){function t(e){r.resolve(e).then(function(e){i||(i=!0,b.resolve(s,e))},function(e){i||(i=!0,b.reject(s,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var u=-1,s=new this(n);++u<o;)t(e[u]);return s}var p=e(1),b={},v=["REJECTED"],y=["FULFILLED"],m=["PENDING"];t.exports=o,o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===y||"function"!=typeof t&&this.state===v)return this;var r=new this.constructor(n);if(this.state!==m){var o=this.state===y?e:t;u(r,o,this.outcome)}else this.queue.push(new i(r,e,t));return r},i.prototype.callFulfilled=function(e){b.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){b.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},b.resolve=function(e,t){var r=c(s,t);if("error"===r.status)return b.reject(e,r.value);var n=r.value;if(n)a(e,n);else{e.state=y,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},b.reject=function(e,t){e.state=v,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},o.resolve=f,o.reject=l,o.all=d,o.race=h},{1:1}],3:[function(e,t,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}function i(){try{if(!ge)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&fetch.toString().indexOf("[native code")!==-1;return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(r){return!1}}function u(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,o=new n,i=0;i<e.length;i+=1)o.append(e[i]);return o.getBlob(t.type)}}function s(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function a(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e["catch"](r)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function l(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}function d(e){return new Oe(function(t){var r=e.transaction(je,xe),n=u([""]);r.objectStore(je).put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}})["catch"](function(){return!1})}function h(e){return"boolean"==typeof we?Oe.resolve(we):d(e).then(function(e){return we=e})}function p(e){var t=Se[e.name],r={};r.promise=new Oe(function(e,t){r.resolve=e,r.reject=t}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function b(e){var t=Se[e.name],r=t.deferredOperations.pop();if(r)return r.resolve(),r.promise}function v(e,t){var r=Se[e.name],n=r.deferredOperations.pop();if(n)return n.reject(t),n.promise}function y(e,t){return new Oe(function(r,n){if(Se[e.name]=Se[e.name]||x(),e.db){if(!t)return r(e.db);p(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=ge.open.apply(ge,o);t&&(i.onupgradeneeded=function(t){var r=i.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(je)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){r(i.result),b(e)}})}function m(e){return y(e,!1)}function _(e){return y(e,!0)}function g(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,o=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function O(e){return new Oe(function(t,r){var n=new FileReader;n.onerror=r,n.onloadend=function(r){var n=btoa(r.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},n.readAsBinaryString(e)})}function j(e){var t=l(atob(e.data));return u([t],{type:e.type})}function w(e){return e&&e.__local_forage_encoded_blob}function S(e){var t=this,r=t._initReady().then(function(){var e=Se[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return a(r,e,e),r}function E(e){p(e);for(var t=Se[e.name],r=t.forages,n=0;n<r.length;n++){var o=r[n];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,m(e).then(function(t){return e.db=t,g(e)?_(e):t}).then(function(n){e.db=t.db=n;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=n})["catch"](function(t){throw v(e,t),t})}function P(e,t,r,n){void 0===n&&(n=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(i){if(n>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return Oe.resolve().then(function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),_(e)}).then(function(){return E(e).then(function(){P(e,t,r,n-1)})})["catch"](r);r(i)}}function x(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function A(e){function t(){return Oe.resolve()}var r=this,n={db:null};if(e)for(var o in e)n[o]=e[o];var i=Se[n.name];i||(i=x(),Se[n.name]=i),i.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=S);for(var u=[],s=0;s<i.forages.length;s++){var a=i.forages[s];a!==r&&u.push(a._initReady()["catch"](t))}var c=i.forages.slice(0);return Oe.all(u).then(function(){return n.db=i.db,m(n)}).then(function(e){return n.db=e,g(n,r._defaultConfig.version)?_(n):e}).then(function(e){n.db=i.db=e,r._dbInfo=n;for(var t=0;t<c.length;t++){var o=c[t];o!==r&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})}function I(e,t){var r=this;e=c(e);var n=new Oe(function(t,n){r.ready().then(function(){P(r._dbInfo,Pe,function(o,i){if(o)return n(o);try{var u=i.objectStore(r._dbInfo.storeName),s=u.get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),w(e)&&(e=j(e)),t(e)},s.onerror=function(){n(s.error)}}catch(a){n(a)}})})["catch"](n)});return s(n,t),n}function k(e,t){var r=this,n=new Oe(function(t,n){r.ready().then(function(){P(r._dbInfo,Pe,function(o,i){if(o)return n(o);try{var u=i.objectStore(r._dbInfo.storeName),s=u.openCursor(),a=1;s.onsuccess=function(){var r=s.result;if(r){var n=r.value;w(n)&&(n=j(n));var o=e(n,r.key,a++);void 0!==o?t(o):r["continue"]()}else t()},s.onerror=function(){n(s.error)}}catch(c){n(c)}})})["catch"](n)});return s(n,t),n}function M(e,t,r){var n=this;e=c(e);var o=new Oe(function(r,o){var i;n.ready().then(function(){return i=n._dbInfo,"[object Blob]"===Ee.call(t)?h(i.db).then(function(e){return e?t:O(t)}):t}).then(function(t){P(n._dbInfo,xe,function(i,u){if(i)return o(i);try{var s=u.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var a=s.put(t,e);u.oncomplete=function(){void 0===t&&(t=null),r(t)},u.onabort=u.onerror=function(){var e=a.error?a.error:a.transaction.error;o(e)}}catch(c){o(c)}})})["catch"](o)});return s(o,r),o}function N(e,t){var r=this;e=c(e);var n=new Oe(function(t,n){r.ready().then(function(){P(r._dbInfo,xe,function(o,i){if(o)return n(o);try{var u=i.objectStore(r._dbInfo.storeName),s=u["delete"](e);i.oncomplete=function(){t()},i.onerror=function(){n(s.error)},i.onabort=function(){var e=s.error?s.error:s.transaction.error;n(e)}}catch(a){n(a)}})})["catch"](n)});return s(n,t),n}function T(e){var t=this,r=new Oe(function(e,r){t.ready().then(function(){P(t._dbInfo,xe,function(n,o){if(n)return r(n);try{var i=o.objectStore(t._dbInfo.storeName),u=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=u.error?u.error:u.transaction.error;r(e)}}catch(s){r(s)}})})["catch"](r)});return s(r,e),r}function C(e){var t=this,r=new Oe(function(e,r){t.ready().then(function(){P(t._dbInfo,Pe,function(n,o){if(n)return r(n);try{var i=o.objectStore(t._dbInfo.storeName),u=i.count();u.onsuccess=function(){e(u.result)},u.onerror=function(){r(u.error);
}}catch(s){r(s)}})})["catch"](r)});return s(r,e),r}function R(e,t){var r=this,n=new Oe(function(t,n){return e<0?void t(null):void r.ready().then(function(){P(r._dbInfo,Pe,function(o,i){if(o)return n(o);try{var u=i.objectStore(r._dbInfo.storeName),s=!1,a=u.openCursor();a.onsuccess=function(){var r=a.result;return r?void(0===e?t(r.key):s?t(r.key):(s=!0,r.advance(e))):void t(null)},a.onerror=function(){n(a.error)}}catch(c){n(c)}})})["catch"](n)});return s(n,t),n}function D(e){var t=this,r=new Oe(function(e,r){t.ready().then(function(){P(t._dbInfo,Pe,function(n,o){if(n)return r(n);try{var i=o.objectStore(t._dbInfo.storeName),u=i.openCursor(),s=[];u.onsuccess=function(){var t=u.result;return t?(s.push(t.key),void t["continue"]()):void e(s)},u.onerror=function(){r(u.error)}}catch(a){r(a)}})})["catch"](r)});return s(r,e),r}function $(e,t){t=f.apply(this,arguments);var r=this.config();e="function"!=typeof e&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;if(e.name){var i=e.name===r.name&&o._dbInfo.db,u=i?Oe.resolve(o._dbInfo.db):m(e).then(function(t){var r=Se[e.name],n=r.forages;r.db=t;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=t;return t});n=e.storeName?u.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;p(e);var n=Se[e.name],o=n.forages;t.close();for(var i=0;i<o.length;i++){var u=o[i];u._dbInfo.db=null,u._dbInfo.version=r}var s=new Oe(function(t,n){var o=ge.open(e.name,r);o.onerror=function(e){var t=o.result;t.close(),n(e)},o.onupgradeneeded=function(){var t=o.result;t.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}});return s.then(function(e){n.db=e;for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=e,b(r._dbInfo)}})["catch"](function(t){throw(v(e,t)||Oe.resolve())["catch"](function(){}),t})}}):u.then(function(t){p(e);var r=Se[e.name],n=r.forages;t.close();for(var o=0;o<n.length;o++){var i=n[o];i._dbInfo.db=null}var u=new Oe(function(t,r){var n=ge.deleteDatabase(e.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}});return u.then(function(e){r.db=e;for(var t=0;t<n.length;t++){var o=n[t];b(o._dbInfo)}})["catch"](function(t){throw(v(e,t)||Oe.resolve())["catch"](function(){}),t})})}else n=Oe.reject("Invalid arguments");return s(n,t),n}function F(){return"function"==typeof openDatabase}function B(e){var t,r,n,o,i,u=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(u--,"="===e[e.length-2]&&u--);var c=new ArrayBuffer(u),f=new Uint8Array(c);for(t=0;t<s;t+=4)r=Ie.indexOf(e[t]),n=Ie.indexOf(e[t+1]),o=Ie.indexOf(e[t+2]),i=Ie.indexOf(e[t+3]),f[a++]=r<<2|n>>4,f[a++]=(15&n)<<4|o>>2,f[a++]=(3&o)<<6|63&i;return c}function q(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=Ie[r[t]>>2],n+=Ie[(3&r[t])<<4|r[t+1]>>4],n+=Ie[(15&r[t+1])<<2|r[t+2]>>6],n+=Ie[63&r[t+2]];return r.length%3===2?n=n.substring(0,n.length-1)+"=":r.length%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function U(e,t){var r="";if(e&&(r=We.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===We.call(e.buffer))){var n,o=Ne;e instanceof ArrayBuffer?(n=e,o+=Ce):(n=e.buffer,"[object Int8Array]"===r?o+=De:"[object Uint8Array]"===r?o+=$e:"[object Uint8ClampedArray]"===r?o+=Fe:"[object Int16Array]"===r?o+=Be:"[object Uint16Array]"===r?o+=Ue:"[object Int32Array]"===r?o+=qe:"[object Uint32Array]"===r?o+=Le:"[object Float32Array]"===r?o+=Ve:"[object Float64Array]"===r?o+=Je:t(new Error("Failed to get type for BinaryArray"))),t(o+q(n))}else if("[object Blob]"===r){var i=new FileReader;i.onload=function(){var r=ke+e.type+"~"+q(this.result);t(Ne+Re+r)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(u){console.error("Couldn't convert value into a JSON string: ",e),t(null,u)}}function L(e){if(e.substring(0,Te)!==Ne)return JSON.parse(e);var t,r=e.substring(ze),n=e.substring(Te,ze);if(n===Re&&Me.test(r)){var o=r.match(Me);t=o[1],r=r.substring(o[0].length)}var i=B(r);switch(n){case Ce:return i;case Re:return u([i],{type:t});case De:return new Int8Array(i);case $e:return new Uint8Array(i);case Fe:return new Uint8ClampedArray(i);case Be:return new Int16Array(i);case Ue:return new Uint16Array(i);case qe:return new Int32Array(i);case Le:return new Uint32Array(i);case Ve:return new Float32Array(i);case Je:return new Float64Array(i);default:throw new Error("Unkown type: "+n)}}function V(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function J(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var o=new Oe(function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(o){return n(o)}r.db.transaction(function(o){V(o,r,function(){t._dbInfo=r,e()},function(e,t){n(t)})},n)});return r.serializer=Ye,o}function z(e,t,r,n,o,i){e.executeSql(r,n,o,function(e,u){u.code===u.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,s){s.rows.length?i(e,u):V(e,t,function(){e.executeSql(r,n,o,i)},i)},i):i(e,u)},i)}function W(e,t){var r=this;e=c(e);var n=new Oe(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){z(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=o.serializer.deserialize(n)),t(n)},function(e,t){n(t)})})})["catch"](n)});return s(n,t),n}function Y(e,t){var r=this,n=new Oe(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){z(r,o,"SELECT * FROM "+o.storeName,[],function(r,n){for(var i=n.rows,u=i.length,s=0;s<u;s++){var a=i.item(s),c=a.value;if(c&&(c=o.serializer.deserialize(c)),c=e(c,a.key,s+1),void 0!==c)return void t(c)}t()},function(e,t){n(t)})})})["catch"](n)});return s(n,t),n}function Q(e,t,r,n){var o=this;e=c(e);var i=new Oe(function(i,u){o.ready().then(function(){void 0===t&&(t=null);var s=t,a=o._dbInfo;a.serializer.serialize(t,function(t,c){c?u(c):a.db.transaction(function(r){z(r,a,"INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){i(s)},function(e,t){u(t)})},function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void i(Q.apply(o,[e,s,r,n-1]));u(t)}})})})["catch"](u)});return s(i,r),i}function G(e,t,r){return Q.apply(this,[e,t,r,1])}function H(e,t){var r=this;e=c(e);var n=new Oe(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){z(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){n(t)})})})["catch"](n)});return s(n,t),n}function K(e){var t=this,r=new Oe(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){z(t,n,"DELETE FROM "+n.storeName,[],function(){e()},function(e,t){r(t)})})})["catch"](r)});return s(r,e),r}function X(e){var t=this,r=new Oe(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){z(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(t,r){var n=r.rows.item(0).c;e(n)},function(e,t){r(t)})})})["catch"](r)});return s(r,e),r}function Z(e,t){var r=this,n=new Oe(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){z(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)},function(e,t){n(t)})})})["catch"](n)});return s(n,t),n}function ee(e){var t=this,r=new Oe(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){z(t,n,"SELECT key FROM "+n.storeName,[],function(t,r){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o).key);e(n)},function(e,t){r(t)})})})["catch"](r)});return s(r,e),r}function te(e){return new Oe(function(t,r){e.transaction(function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(r,n){for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i).name);t({db:e,storeNames:o})},function(e,t){r(t)})},function(e){r(e)})})}function re(e,t){t=f.apply(this,arguments);var r=this.config();e="function"!=typeof e&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,o=this;return n=e.name?new Oe(function(t){var n;n=e.name===r.name?o._dbInfo.db:openDatabase(e.name,"","",0),t(e.storeName?{db:n,storeNames:[e.storeName]}:te(n))}).then(function(e){return new Oe(function(t,r){e.db.transaction(function(n){function o(e){return new Oe(function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){r(t)})})}for(var i=[],u=0,s=e.storeNames.length;u<s;u++)i.push(o(e.storeNames[u]));Oe.all(i).then(function(){t()})["catch"](function(e){r(e)})},function(e){r(e)})})}):Oe.reject("Invalid arguments"),s(n,t),n}function ne(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function oe(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function ie(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(t){return!0}}function ue(){return!ie()||localStorage.length>0}function se(e){var t=this,r={};if(e)for(var n in e)r[n]=e[n];return r.keyPrefix=oe(e,t._defaultConfig),ue()?(t._dbInfo=r,r.serializer=Ye,Oe.resolve()):Oe.reject()}function ae(e){var t=this,r=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}});return s(r,e),r}function ce(e,t){var r=this;e=c(e);var n=r.ready().then(function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n});return s(n,t),n}function fe(e,t){var r=this,n=r.ready().then(function(){for(var t=r._dbInfo,n=t.keyPrefix,o=n.length,i=localStorage.length,u=1,s=0;s<i;s++){var a=localStorage.key(s);if(0===a.indexOf(n)){var c=localStorage.getItem(a);if(c&&(c=t.serializer.deserialize(c)),c=e(c,a.substring(o),u++),void 0!==c)return c}}});return s(n,t),n}function le(e,t){var r=this,n=r.ready().then(function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(o){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t});return s(n,t),n}function de(e){var t=this,r=t.ready().then(function(){for(var e=t._dbInfo,r=localStorage.length,n=[],o=0;o<r;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&n.push(i.substring(e.keyPrefix.length))}return n});return s(r,e),r}function he(e){var t=this,r=t.keys().then(function(e){return e.length});return s(r,e),r}function pe(e,t){var r=this;e=c(e);var n=r.ready().then(function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return s(n,t),n}function be(e,t,r){var n=this;e=c(e);var o=n.ready().then(function(){void 0===t&&(t=null);var r=t;return new Oe(function(o,i){var u=n._dbInfo;u.serializer.serialize(t,function(t,n){if(n)i(n);else try{localStorage.setItem(u.keyPrefix+e,t),o(r)}catch(s){"QuotaExceededError"!==s.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==s.name||i(s),i(s)}})})});return s(o,r),o}function ve(e,t){if(t=f.apply(this,arguments),e="function"!=typeof e&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,o=this;return n=e.name?new Oe(function(t){t(e.storeName?oe(e,o._defaultConfig):e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}}):Oe.reject("Invalid arguments"),s(n,t),n}function ye(e,t){e[t]=function(){var r=arguments;return e.ready().then(function(){return e[t].apply(e,r)})}}function me(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(Xe(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge=o();"undefined"==typeof Promise&&e(3);var Oe=Promise,je="local-forage-detect-blob-support",we=void 0,Se={},Ee=Object.prototype.toString,Pe="readonly",xe="readwrite",Ae={_driver:"asyncStorage",_initStorage:A,_support:i(),iterate:k,getItem:I,setItem:M,removeItem:N,clear:T,length:C,key:R,keys:D,dropInstance:$},Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ke="~~local_forage_type~",Me=/^~~local_forage_type~([^~]+)~/,Ne="__lfsc__:",Te=Ne.length,Ce="arbf",Re="blob",De="si08",$e="ui08",Fe="uic8",Be="si16",qe="si32",Ue="ur16",Le="ui32",Ve="fl32",Je="fl64",ze=Te+Ce.length,We=Object.prototype.toString,Ye={serialize:U,deserialize:L,stringToBuffer:B,bufferToString:q},Qe={_driver:"webSQLStorage",_initStorage:J,_support:F(),iterate:Y,getItem:W,setItem:G,removeItem:H,clear:K,length:X,key:Z,keys:ee,dropInstance:re},Ge={_driver:"localStorageWrapper",_initStorage:se,_support:ne(),iterate:fe,getItem:ce,setItem:be,removeItem:pe,clear:ae,length:he,key:le,keys:de,dropInstance:ve},He=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ke=function(e,t){for(var r=e.length,n=0;n<r;){if(He(e[n],t))return!0;n++}return!1},Xe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ze={},et={},tt={INDEXEDDB:Ae,WEBSQL:Qe,LOCALSTORAGE:Ge},rt=[tt.INDEXEDDB._driver,tt.WEBSQL._driver,tt.LOCALSTORAGE._driver],nt=["dropInstance"],ot=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(nt),it={description:"",driver:rt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},ut=function(){function e(t){n(this,e);for(var r in tt)if(tt.hasOwnProperty(r)){var o=tt[r],i=o._driver;this[r]=i,Ze[i]||this.defineDriver(o)}this._defaultConfig=me({},it),this._config=me({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)["catch"](function(){})}return e.prototype.config=function(e){if("object"===("undefined"==typeof e?"undefined":_e(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new Oe(function(t,r){try{var n=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(o);for(var i=ot.concat("_initStorage"),u=0,a=i.length;u<a;u++){var c=i[u],f=!Ke(nt,c);if((f||e[c])&&"function"!=typeof e[c])return void r(o)}var l=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=Oe.reject(t);return s(r,arguments[arguments.length-1]),r}},r=0,n=nt.length;r<n;r++){var o=nt[r];e[o]||(e[o]=t(o))}};l();var d=function(r){Ze[n]&&console.info("Redefining LocalForage driver: "+n),Ze[n]=e,et[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,r):d(!!e._support):d(!0)}catch(h){r(h)}});return a(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=Ze[e]?Oe.resolve(Ze[e]):Oe.reject(new Error("Driver not found."));return a(n,t,r),n},e.prototype.getSerializer=function(e){var t=Oe.resolve(Ye);return a(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return a(r,e,e),r},e.prototype.setDriver=function(e,t,r){function n(){u._config.driver=u.driver()}function o(e){return u._extend(e),n(),u._ready=u._initStorage(u._config),u._ready}function i(e){return function(){function t(){for(;r<e.length;){var i=e[r];return r++,u._dbInfo=null,u._ready=null,u.getDriver(i).then(o)["catch"](t)}n();var s=new Error("No available storage method found.");return u._driverSet=Oe.reject(s),u._driverSet}var r=0;return t()}}var u=this;Xe(e)||(e=[e]);var s=this._getSupportedDrivers(e),c=null!==this._driverSet?this._driverSet["catch"](function(){return Oe.resolve()}):Oe.resolve();return this._driverSet=c.then(function(){var e=s[0];return u._dbInfo=null,u._ready=null,u.getDriver(e).then(function(e){u._driver=e._driver,n(),u._wrapLibraryMethodsWithReady(),u._initDriver=i(s)})})["catch"](function(){n();var e=new Error("No available storage method found.");return u._driverSet=Oe.reject(e),u._driverSet}),a(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!et[e]},e.prototype._extend=function(e){me(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e[r];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ot.length;e<t;e++)ye(this,ot[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),st=new ut;t.exports=st},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],59:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function u(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){v&&p&&(v=!1,p.length?b=p.concat(b):y=-1,b.length&&a())}function a(){if(!v){var e=i(s);v=!0;for(var t=b.length;t;){for(p=b,b=[];++y<t;)p&&p[y].run();y=-1,t=b.length}p=null,v=!1,u(e)}}function c(e,t){this.fun=e,this.array=t}function f(){}var l,d,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(e){d=o}}();var p,b=[],v=!1,y=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];b.push(new c(e,t)),1!==b.length||v||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=f,h.addListener=f,h.once=f,h.off=f,h.removeListener=f,h.removeAllListeners=f,h.emit=f,h.prependListener=f,h.prependOnceListener=f,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./internal/Observable");r.Observable=n.Observable;var o=e("./internal/observable/ConnectableObservable");r.ConnectableObservable=o.ConnectableObservable;var i=e("./internal/operators/groupBy");r.GroupedObservable=i.GroupedObservable;var u=e("./internal/symbol/observable");r.observable=u.observable;var s=e("./internal/Subject");r.Subject=s.Subject;var a=e("./internal/BehaviorSubject");r.BehaviorSubject=a.BehaviorSubject;var c=e("./internal/ReplaySubject");r.ReplaySubject=c.ReplaySubject;var f=e("./internal/AsyncSubject");r.AsyncSubject=f.AsyncSubject;var l=e("./internal/scheduler/asap");r.asapScheduler=l.asap;var d=e("./internal/scheduler/async");r.asyncScheduler=d.async;var h=e("./internal/scheduler/queue");r.queueScheduler=h.queue;var p=e("./internal/scheduler/animationFrame");r.animationFrameScheduler=p.animationFrame;var b=e("./internal/scheduler/VirtualTimeScheduler");r.VirtualTimeScheduler=b.VirtualTimeScheduler,r.VirtualAction=b.VirtualAction;var v=e("./internal/Scheduler");r.Scheduler=v.Scheduler;var y=e("./internal/Subscription");r.Subscription=y.Subscription;var m=e("./internal/Subscriber");r.Subscriber=m.Subscriber;var _=e("./internal/Notification");r.Notification=_.Notification,r.NotificationKind=_.NotificationKind;var g=e("./internal/util/pipe");r.pipe=g.pipe;var O=e("./internal/util/noop");r.noop=O.noop;var j=e("./internal/util/identity");r.identity=j.identity;var w=e("./internal/util/isObservable");r.isObservable=w.isObservable;var S=e("./internal/util/ArgumentOutOfRangeError");r.ArgumentOutOfRangeError=S.ArgumentOutOfRangeError;var E=e("./internal/util/EmptyError");r.EmptyError=E.EmptyError;var P=e("./internal/util/ObjectUnsubscribedError");r.ObjectUnsubscribedError=P.ObjectUnsubscribedError;var x=e("./internal/util/UnsubscriptionError");r.UnsubscriptionError=x.UnsubscriptionError;var A=e("./internal/util/TimeoutError");r.TimeoutError=A.TimeoutError;var I=e("./internal/observable/bindCallback");r.bindCallback=I.bindCallback;var k=e("./internal/observable/bindNodeCallback");r.bindNodeCallback=k.bindNodeCallback;var M=e("./internal/observable/combineLatest");r.combineLatest=M.combineLatest;var N=e("./internal/observable/concat");r.concat=N.concat;var T=e("./internal/observable/defer");r.defer=T.defer;var C=e("./internal/observable/empty");r.empty=C.empty;var R=e("./internal/observable/forkJoin");r.forkJoin=R.forkJoin;var D=e("./internal/observable/from");r.from=D.from;var $=e("./internal/observable/fromEvent");r.fromEvent=$.fromEvent;var F=e("./internal/observable/fromEventPattern");r.fromEventPattern=F.fromEventPattern;var B=e("./internal/observable/generate");r.generate=B.generate;var q=e("./internal/observable/iif");r.iif=q.iif;var U=e("./internal/observable/interval");r.interval=U.interval;var L=e("./internal/observable/merge");r.merge=L.merge;var V=e("./internal/observable/never");r.never=V.never;var J=e("./internal/observable/of");r.of=J.of;var z=e("./internal/observable/onErrorResumeNext");r.onErrorResumeNext=z.onErrorResumeNext;var W=e("./internal/observable/pairs");r.pairs=W.pairs;var Y=e("./internal/observable/partition");r.partition=Y.partition;var Q=e("./internal/observable/race");r.race=Q.race;var G=e("./internal/observable/range");r.range=G.range;var H=e("./internal/observable/throwError");r.throwError=H.throwError;var K=e("./internal/observable/timer");r.timer=K.timer;var X=e("./internal/observable/using");r.using=X.using;var Z=e("./internal/observable/zip");r.zip=Z.zip;var ee=e("./internal/scheduled/scheduled");r.scheduled=ee.scheduled;var te=e("./internal/observable/empty");r.EMPTY=te.EMPTY;var re=e("./internal/observable/never");r.NEVER=re.NEVER;var ne=e("./internal/config");r.config=ne.config},{"./internal/AsyncSubject":61,"./internal/BehaviorSubject":62,"./internal/Notification":64,"./internal/Observable":65,"./internal/ReplaySubject":68,"./internal/Scheduler":69,"./internal/Subject":70,"./internal/Subscriber":72,"./internal/Subscription":73,"./internal/config":74,"./internal/observable/ConnectableObservable":75,"./internal/observable/bindCallback":76,"./internal/observable/bindNodeCallback":77,"./internal/observable/combineLatest":78,"./internal/observable/concat":79,"./internal/observable/defer":80,"./internal/observable/empty":81,"./internal/observable/forkJoin":82,"./internal/observable/from":83,"./internal/observable/fromEvent":85,"./internal/observable/fromEventPattern":86,"./internal/observable/generate":87,"./internal/observable/iif":88,"./internal/observable/interval":89,"./internal/observable/merge":90,"./internal/observable/never":91,"./internal/observable/of":92,"./internal/observable/onErrorResumeNext":93,"./internal/observable/pairs":94,"./internal/observable/partition":95,"./internal/observable/race":96,"./internal/observable/range":97,"./internal/observable/throwError":98,"./internal/observable/timer":99,"./internal/observable/using":100,"./internal/observable/zip":101,"./internal/operators/groupBy":104,"./internal/scheduled/scheduled":114,"./internal/scheduler/VirtualTimeScheduler":124,"./internal/scheduler/animationFrame":125,"./internal/scheduler/asap":126,"./internal/scheduler/async":127,"./internal/scheduler/queue":128,"./internal/symbol/observable":130,"./internal/util/ArgumentOutOfRangeError":132,"./internal/util/EmptyError":133,"./internal/util/ObjectUnsubscribedError":135,"./internal/util/TimeoutError":136,"./internal/util/UnsubscriptionError":137,"./internal/util/identity":140,"./internal/util/isObservable":148,"./internal/util/noop":151,"./internal/util/pipe":153}],61:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Subject"),i=e("./Subscription"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return n(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),i.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),i.Subscription.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(o.Subject);r.AsyncSubject=u},{"./Subject":70,"./Subscription":73}],62:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Subject"),i=e("./util/ObjectUnsubscribedError"),u=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return n(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return r&&!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new i.ObjectUnsubscribedError;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(o.Subject);r.BehaviorSubject=u},{"./Subject":70,"./util/ObjectUnsubscribedError":135}],63:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Subscriber"),i=function(e){function t(t,r,n){var o=e.call(this)||this;return o.parent=t,o.outerValue=r,o.outerIndex=n,o.index=0,o}return n(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(o.Subscriber);r.InnerSubscriber=i},{"./Subscriber":72}],64:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=e("./observable/empty"),i=e("./observable/of"),u=e("./observable/throwError");!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(n=r.NotificationKind||(r.NotificationKind={}));var s=function(){function e(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype["do"]=function(e,t,r){var n=this.kind;switch(n){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}},e.prototype.accept=function(e,t,r){return e&&"function"==typeof e.next?this.observe(e):this["do"](e,t,r)},e.prototype.toObservable=function(){var e=this.kind;switch(e){case"N":return i.of(this.value);case"E":return u.throwError(this.error);case"C":return o.empty()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return"undefined"!=typeof t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",(void 0),t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",(void 0)),e}();r.Notification=s},{"./observable/empty":81,"./observable/of":92,"./observable/throwError":98}],65:[function(e,t,r){"use strict";function n(e){if(e||(e=a.config.Promise||Promise),!e)throw new Error("no Promise impl found");return e}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./util/canReportError"),i=e("./util/toSubscriber"),u=e("./symbol/observable"),s=e("./util/pipe"),a=e("./config"),c=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,o=i.toSubscriber(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||a.config.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),a.config.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){a.config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),o.canReportError(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=n(t))(function(t,n){var o;o=r.subscribe(function(t){try{e(t)}catch(r){n(r),o&&o.unsubscribe()}},n,t)})},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[u.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:s.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=n(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();r.Observable=c},{"./config":74,"./symbol/observable":130,"./util/canReportError":138,"./util/pipe":153,"./util/toSubscriber":160}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./config"),o=e("./util/hostReportError");r.empty={closed:!0,next:function(e){},error:function(e){if(n.config.useDeprecatedSynchronousErrorHandling)throw e;o.hostReportError(e)},complete:function(){}}},{"./config":74,"./util/hostReportError":139}],67:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Subscriber"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.notifyNext=function(e,t,r,n,o){
this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(o.Subscriber);r.OuterSubscriber=i},{"./Subscriber":72}],68:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Subject"),i=e("./scheduler/queue"),u=e("./Subscription"),s=e("./operators/observeOn"),a=e("./util/ObjectUnsubscribedError"),c=e("./SubjectSubscription"),f=function(e){function t(t,r,n){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY);var o=e.call(this)||this;return o.scheduler=n,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=t<1?1:t,o._windowTime=r<1?1:r,r===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return n(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var r=this._events;r.push(t),r.length>this._bufferSize&&r.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new l(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,r=this._infiniteTimeWindow,n=r?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,i=n.length;if(this.closed)throw new a.ObjectUnsubscribedError;if(this.isStopped||this.hasError?t=u.Subscription.EMPTY:(this.observers.push(e),t=new c.SubjectSubscription(this,e)),o&&e.add(e=new s.ObserveOnSubscriber(e,o)),r)for(var f=0;f<i&&!e.closed;f++)e.next(n[f]);else for(var f=0;f<i&&!e.closed;f++)e.next(n[f].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||i.queue).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,r=this._windowTime,n=this._events,o=n.length,i=0;i<o&&!(e-n[i].time<r);)i++;return o>t&&(i=Math.max(i,o-t)),i>0&&n.splice(0,i),n},t}(o.Subject);r.ReplaySubject=f;var l=function(){function e(e,t){this.time=e,this.value=t}return e}()},{"./Subject":70,"./SubjectSubscription":71,"./Subscription":73,"./operators/observeOn":108,"./scheduler/queue":128,"./util/ObjectUnsubscribedError":135}],69:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(t,r){void 0===r&&(r=e.now),this.SchedulerAction=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(r,t)},e.now=function(){return Date.now()},e}();r.Scheduler=n},{}],70:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Observable"),i=e("./Subscriber"),u=e("./Subscription"),s=e("./util/ObjectUnsubscribedError"),a=e("./SubjectSubscription"),c=e("../internal/symbol/rxSubscriber"),f=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return n(t,e),t}(i.Subscriber);r.SubjectSubscriber=f;var l=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n(t,e),t.prototype[c.rxSubscriber]=function(){return new f(this)},t.prototype.lift=function(e){var t=new d(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new s.ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new s.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new s.ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),u.Subscription.EMPTY):this.isStopped?(e.complete(),u.Subscription.EMPTY):(this.observers.push(e),new a.SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new o.Observable;return e.source=this,e},t.create=function(e,t){return new d(e,t)},t}(o.Observable);r.Subject=l;var d=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return n(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){var t=this.source;return t?this.source.subscribe(e):u.Subscription.EMPTY},t}(l);r.AnonymousSubject=d},{"../internal/symbol/rxSubscriber":131,"./Observable":65,"./SubjectSubscription":71,"./Subscriber":72,"./Subscription":73,"./util/ObjectUnsubscribedError":135}],71:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Subscription"),i=function(e){function t(t,r){var n=e.call(this)||this;return n.subject=t,n.subscriber=r,n.closed=!1,n}return n(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);r!==-1&&t.splice(r,1)}}},t}(o.Subscription);r.SubjectSubscription=i},{"./Subscription":73}],72:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./util/isFunction"),i=e("./Observer"),u=e("./Subscription"),s=e("../internal/symbol/rxSubscriber"),a=e("./config"),c=e("./util/hostReportError"),f=function(e){function t(r,n,o){var u=e.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=i.empty;break;case 1:if(!r){u.destination=i.empty;break}if("object"==typeof r){r instanceof t?(u.syncErrorThrowable=r.syncErrorThrowable,u.destination=r,r.add(u)):(u.syncErrorThrowable=!0,u.destination=new l(u,r));break}default:u.syncErrorThrowable=!0,u.destination=new l(u,r,n,o)}return u}return n(t,e),t.prototype[s.rxSubscriber]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(u.Subscription);r.Subscriber=f;var l=function(e){function t(t,r,n,u){var s=e.call(this)||this;s._parentSubscriber=t;var a,c=s;return o.isFunction(r)?a=r:r&&(a=r.next,n=r.error,u=r.complete,r!==i.empty&&(c=Object.create(r),o.isFunction(c.unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s._context=c,s._next=a,s._error=n,s._complete=u,s}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;a.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=a.config.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):c.hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;c.hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};a.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),a.config.useDeprecatedSynchronousErrorHandling)throw r;c.hostReportError(r)}},t.prototype.__tryOrSetError=function(e,t,r){if(!a.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(n){return a.config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(c.hostReportError(n),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(f);r.SafeSubscriber=l},{"../internal/symbol/rxSubscriber":131,"./Observer":66,"./Subscription":73,"./config":74,"./util/hostReportError":139,"./util/isFunction":143}],73:[function(e,t,r){"use strict";function n(e){return e.reduce(function(e,t){return e.concat(t instanceof s.UnsubscriptionError?t.errors:t)},[])}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./util/isArray"),i=e("./util/isObject"),u=e("./util/isFunction"),s=e("./util/UnsubscriptionError"),a=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this,a=r._parentOrParents,c=r._unsubscribe,f=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,a instanceof e)a.remove(this);else if(null!==a)for(var l=0;l<a.length;++l){var d=a[l];d.remove(this)}if(u.isFunction(c))try{c.call(this)}catch(h){t=h instanceof s.UnsubscriptionError?n(h.errors):[h]}if(o.isArray(f))for(var l=-1,p=f.length;++l<p;){var b=f[l];if(i.isObject(b))try{b.unsubscribe()}catch(h){t=t||[],h instanceof s.UnsubscriptionError?t=t.concat(n(h.errors)):t.push(h)}}if(t)throw new s.UnsubscriptionError(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;r=new e,r._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof e){if(o===this)return r;r._parentOrParents=[o,this]}else{if(o.indexOf(this)!==-1)return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);r!==-1&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();r.Subscription=a},{"./util/UnsubscriptionError":137,"./util/isArray":141,"./util/isFunction":143,"./util/isObject":147}],74:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=!1;r.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else n&&console.log("RxJS: Back to a better error behavior. Thank you. <3");n=e},get useDeprecatedSynchronousErrorHandling(){return n}}},{}],75:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Subject"),i=e("../Observable"),u=e("../Subscriber"),s=e("../Subscription"),a=e("../operators/refCount"),c=function(e){function t(t,r){var n=e.call(this)||this;return n.source=t,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return n(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,e=this._connection=new s.Subscription,e.add(this.source.subscribe(new l(this.getSubject(),this))),e.closed&&(this._connection=null,e=s.Subscription.EMPTY)),e},t.prototype.refCount=function(){return a.refCount()(this)},t}(i.Observable);r.ConnectableObservable=c;var f=c.prototype;r.connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:f._subscribe},_isComplete:{value:f._isComplete,writable:!0},getSubject:{value:f.getSubject},connect:{value:f.connect},refCount:{value:f.refCount}};var l=function(e){function t(t,r){var n=e.call(this,t)||this;return n.connectable=r,n}return n(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(o.SubjectSubscriber),d=(function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var r=this.connectable;r._refCount++;var n=new d(e,r),o=t.subscribe(n);return n.closed||(n.connection=r.connect()),o},e}(),function(e){function t(t,r){var n=e.call(this,t)||this;return n.connectable=r,n}return n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(!e)return void(this.connection=null);this.connectable=null;var t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);var r=this.connection,n=e._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()},t}(u.Subscriber))},{"../Observable":65,"../Subject":70,"../Subscriber":72,"../Subscription":73,"../operators/refCount":109}],76:[function(e,t,r){"use strict";function n(e,t,r){if(t){if(!l.isScheduler(t))return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n(e,r).apply(void 0,o).pipe(a.map(function(e){return f.isArray(e)?t.apply(void 0,e):t(e)}))};r=t}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i,a=this,f={context:a,subject:i,callbackFunc:e,scheduler:r};return new u.Observable(function(n){if(r){var u={args:t,subscriber:n,params:f};return r.schedule(o,0,u)}if(!i){i=new s.AsyncSubject;var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.next(e.length<=1?e[0]:e),i.complete()};try{e.apply(a,t.concat([l]))}catch(d){c.canReportError(i)?i.error(d):console.warn(d)}}return i.subscribe(n)})}}function o(e){var t=this,r=e.args,n=e.subscriber,o=e.params,u=o.callbackFunc,a=o.context,c=o.scheduler,f=o.subject;if(!f){f=o.subject=new s.AsyncSubject;var l=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e.length<=1?e[0]:e;t.add(c.schedule(i,0,{value:n,subject:f}))};try{u.apply(a,r.concat([l]))}catch(d){f.error(d)}}this.add(f.subscribe(n))}function i(e){var t=e.value,r=e.subject;r.next(t),r.complete()}Object.defineProperty(r,"__esModule",{value:!0});var u=e("../Observable"),s=e("../AsyncSubject"),a=e("../operators/map"),c=e("../util/canReportError"),f=e("../util/isArray"),l=e("../util/isScheduler");r.bindCallback=n},{"../AsyncSubject":61,"../Observable":65,"../operators/map":105,"../util/canReportError":138,"../util/isArray":141,"../util/isScheduler":150}],77:[function(e,t,r){"use strict";function n(e,t,r){if(t){if(!l.isScheduler(t))return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n(e,r).apply(void 0,o).pipe(c.map(function(e){return d.isArray(e)?t.apply(void 0,e):t(e)}))};r=t}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i={subject:void 0,args:t,callbackFunc:e,scheduler:r,context:this};return new s.Observable(function(n){var u=i.context,s=i.subject;if(r)return r.schedule(o,0,{params:i,subscriber:n,context:u});if(!s){s=i.subject=new a.AsyncSubject;var c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.shift();return r?void s.error(r):(s.next(e.length<=1?e[0]:e),void s.complete())};try{e.apply(u,t.concat([c]))}catch(l){f.canReportError(s)?s.error(l):console.warn(l)}}return s.subscribe(n)})}}function o(e){var t=this,r=e.params,n=e.subscriber,o=e.context,s=r.callbackFunc,c=r.args,f=r.scheduler,l=r.subject;if(!l){l=r.subject=new a.AsyncSubject;var d=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e.shift();if(n)t.add(f.schedule(u,0,{err:n,subject:l}));else{var o=e.length<=1?e[0]:e;t.add(f.schedule(i,0,{value:o,subject:l}))}};try{s.apply(o,c.concat([d]))}catch(h){this.add(f.schedule(u,0,{err:h,subject:l}))}}this.add(l.subscribe(n))}function i(e){var t=e.value,r=e.subject;r.next(t),r.complete()}function u(e){var t=e.err,r=e.subject;r.error(t)}Object.defineProperty(r,"__esModule",{value:!0});var s=e("../Observable"),a=e("../AsyncSubject"),c=e("../operators/map"),f=e("../util/canReportError"),l=e("../util/isScheduler"),d=e("../util/isArray");r.bindNodeCallback=n},{"../AsyncSubject":61,"../Observable":65,"../operators/map":105,"../util/canReportError":138,"../util/isArray":141,"../util/isScheduler":150}],78:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=null,n=null;return i.isScheduler(e[e.length-1])&&(n=e.pop()),"function"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&u.isArray(e[0])&&(e=e[0]),c.fromArray(e,n).lift(new l(r))}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../util/isScheduler"),u=e("../util/isArray"),s=e("../OuterSubscriber"),a=e("../util/subscribeToResult"),c=e("./fromArray"),f={};r.combineLatest=n;var l=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new d(e,this.resultSelector))},e}();r.CombineLatestOperator=l;var d=function(e){function t(t,r){var n=e.call(this,t)||this;return n.resultSelector=r,n.active=0,n.values=[],n.observables=[],n}return o(t,e),t.prototype._next=function(e){this.values.push(f),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var r=0;r<t;r++){var n=e[r];this.add(a.subscribeToResult(this,n,n,r))}}},t.prototype.notifyComplete=function(e){0===(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,r,n,o){var i=this.values,u=i[r],s=this.toRespond?u===f?--this.toRespond:this.toRespond:0;i[r]=t,0===s&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(r){return void this.destination.error(r)}this.destination.next(t)},t}(s.OuterSubscriber);r.CombineLatestSubscriber=d},{"../OuterSubscriber":67,"../util/isArray":141,"../util/isScheduler":150,"../util/subscribeToResult":159,"./fromArray":84}],79:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.concatAll()(o.of.apply(void 0,e))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./of"),i=e("../operators/concatAll");r.concat=n},{"../operators/concatAll":102,"./of":92}],80:[function(e,t,r){"use strict";function n(e){return new o.Observable(function(t){var r;try{r=e()}catch(n){return void t.error(n)}var o=r?i.from(r):u.empty();return o.subscribe(t)})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("./from"),u=e("./empty");r.defer=n},{"../Observable":65,"./empty":81,"./from":83}],81:[function(e,t,r){"use strict";function n(e){return e?o(e):r.EMPTY}function o(e){return new i.Observable(function(t){return e.schedule(function(){return t.complete()})})}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable");r.EMPTY=new i.Observable(function(e){return e.complete()}),r.empty=n},{"../Observable":65}],82:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var r=e[0];if(u.isArray(r))return o(r,null);if(a.isObject(r)&&Object.getPrototypeOf(r)===Object.prototype){var n=Object.keys(r);return o(n.map(function(e){return r[e]}),n)}}if("function"==typeof e[e.length-1]){var i=e.pop();return e=1===e.length&&u.isArray(e[0])?e[0]:e,o(e,null).pipe(s.map(function(e){return i.apply(void 0,e)}))}return o(e,null)}function o(e,t){return new i.Observable(function(r){var n=e.length;if(0===n)return void r.complete();for(var o=new Array(n),i=0,u=0,s=function(s){var a=c.from(e[s]),f=!1;r.add(a.subscribe({next:function(e){f||(f=!0,u++),o[s]=e},error:function(e){return r.error(e)},complete:function(){i++,i!==n&&f||(u===n&&r.next(t?t.reduce(function(e,t,r){return e[t]=o[r],e},{}):o),r.complete())}}))},a=0;a<n;a++)s(a)})}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable"),u=e("../util/isArray"),s=e("../operators/map"),a=e("../util/isObject"),c=e("./from");r.forkJoin=n},{"../Observable":65,"../operators/map":105,"../util/isArray":141,"../util/isObject":147,"./from":83}],83:[function(e,t,r){"use strict";function n(e,t){return t?u.scheduled(e,t):e instanceof o.Observable?e:new o.Observable(i.subscribeTo(e))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../util/subscribeTo"),u=e("../scheduled/scheduled");r.from=n},{"../Observable":65,"../scheduled/scheduled":114,"../util/subscribeTo":154}],84:[function(e,t,r){"use strict";function n(e,t){return t?u.scheduleArray(e,t):new o.Observable(i.subscribeToArray(e))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../util/subscribeToArray"),u=e("../scheduled/scheduleArray");r.fromArray=n},{"../Observable":65,"../scheduled/scheduleArray":110,"../util/subscribeToArray":155}],85:[function(e,t,r){"use strict";function n(e,t,r,i){return f.isFunction(r)&&(i=r,r=void 0),i?n(e,t,r).pipe(l.map(function(e){return c.isArray(e)?i.apply(void 0,e):i(e)})):new a.Observable(function(n){function i(e){arguments.length>1?n.next(Array.prototype.slice.call(arguments)):n.next(e)}o(e,t,i,n,r)})}function o(e,t,r,n,a){var c;if(s(e)){var f=e;e.addEventListener(t,r,a),c=function(){return f.removeEventListener(t,r,a)}}else if(u(e)){var l=e;e.on(t,r),c=function(){return l.off(t,r)}}else if(i(e)){var d=e;e.addListener(t,r),c=function(){return d.removeListener(t,r)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var h=0,p=e.length;h<p;h++)o(e[h],t,r,n,a)}n.add(c)}function i(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function u(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function s(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}Object.defineProperty(r,"__esModule",{value:!0});var a=e("../Observable"),c=e("../util/isArray"),f=e("../util/isFunction"),l=e("../operators/map");Object.prototype.toString;r.fromEvent=n},{"../Observable":65,"../operators/map":105,"../util/isArray":141,"../util/isFunction":143}],86:[function(e,t,r){"use strict";function n(e,t,r){return r?n(e,t).pipe(s.map(function(e){return i.isArray(e)?r.apply(void 0,e):r(e)})):new o.Observable(function(r){var n,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.next(1===e.length?e[0]:e)};try{n=e(o)}catch(i){return void r.error(i)}if(u.isFunction(t))return function(){return t(o,n)}})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../util/isArray"),u=e("../util/isFunction"),s=e("../operators/map");r.fromEventPattern=n},{"../Observable":65,"../operators/map":105,"../util/isArray":141,"../util/isFunction":143}],87:[function(e,t,r){"use strict";function n(e,t,r,n,a){var c,f;if(1==arguments.length){var l=e;f=l.initialState,t=l.condition,r=l.iterate,c=l.resultSelector||u.identity,a=l.scheduler}else void 0===n||s.isScheduler(n)?(f=e,c=u.identity,a=n):(f=e,c=n);return new i.Observable(function(e){var n=f;if(a)return a.schedule(o,0,{subscriber:e,iterate:r,condition:t,resultSelector:c,state:n});for(;;){if(t){var i=void 0;try{i=t(n)}catch(u){return void e.error(u)}if(!i){e.complete();break}}var s=void 0;try{s=c(n)}catch(u){return void e.error(u)}if(e.next(s),e.closed)break;try{n=r(n)}catch(u){return void e.error(u)}}})}function o(e){var t=e.subscriber,r=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(n){return void t.error(n)}else e.needIterate=!0;if(r){var o=void 0;try{o=r(e.state)}catch(n){return void t.error(n)}if(!o)return void t.complete();if(t.closed)return}var i;try{i=e.resultSelector(e.state)}catch(n){return void t.error(n)}if(!t.closed&&(t.next(i),!t.closed))return this.schedule(e)}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable"),u=e("../util/identity"),s=e("../util/isScheduler");r.generate=n},{"../Observable":65,"../util/identity":140,"../util/isScheduler":150}],88:[function(e,t,r){"use strict";function n(e,t,r){return void 0===t&&(t=i.EMPTY),void 0===r&&(r=i.EMPTY),o.defer(function(){return e()?t:r})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./defer"),i=e("./empty");r.iif=n},{"./defer":80,"./empty":81}],89:[function(e,t,r){"use strict";function n(e,t){return void 0===e&&(e=0),void 0===t&&(t=u.async),(!s.isNumeric(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=u.async),new i.Observable(function(r){return r.add(t.schedule(o,e,{subscriber:r,counter:0,period:e})),r})}function o(e){var t=e.subscriber,r=e.counter,n=e.period;t.next(r),this.schedule({subscriber:t,counter:r+1,period:n},n)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable"),u=e("../scheduler/async"),s=e("../util/isNumeric");r.interval=n},{"../Observable":65,"../scheduler/async":127,"../util/isNumeric":146}],90:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Number.POSITIVE_INFINITY,n=null,a=e[e.length-1];return i.isScheduler(a)?(n=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(r=e.pop())):"number"==typeof a&&(r=e.pop()),null===n&&1===e.length&&e[0]instanceof o.Observable?e[0]:u.mergeAll(r)(s.fromArray(e,n))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../util/isScheduler"),u=e("../operators/mergeAll"),s=e("./fromArray");r.merge=n},{"../Observable":65,"../operators/mergeAll":106,"../util/isScheduler":150,"./fromArray":84}],91:[function(e,t,r){"use strict";function n(){return r.NEVER}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../util/noop");r.NEVER=new o.Observable(i.noop),r.never=n},{"../Observable":65,"../util/noop":151}],92:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return o.isScheduler(r)?(e.pop(),u.scheduleArray(e,r)):i.fromArray(e)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../util/isScheduler"),i=e("./fromArray"),u=e("../scheduled/scheduleArray");r.of=n},{"../scheduled/scheduleArray":110,"../util/isScheduler":150,"./fromArray":84}],93:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return s.EMPTY;var r=e[0],a=e.slice(1);return 1===e.length&&u.isArray(r)?n.apply(void 0,r):new o.Observable(function(e){var t=function(){return e.add(n.apply(void 0,a).subscribe(e))};return i.from(r).subscribe({next:function(t){e.next(t)},error:t,complete:t})})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("./from"),u=e("../util/isArray"),s=e("./empty");r.onErrorResumeNext=n},{"../Observable":65,"../util/isArray":141,"./empty":81,"./from":83}],94:[function(e,t,r){"use strict";function n(e,t){return t?new i.Observable(function(r){var n=Object.keys(e),i=new u.Subscription;return i.add(t.schedule(o,0,{keys:n,index:0,subscriber:r,subscription:i,obj:e})),i}):new i.Observable(function(t){for(var r=Object.keys(e),n=0;n<r.length&&!t.closed;n++){var o=r[n];e.hasOwnProperty(o)&&t.next([o,e[o]])}t.complete()})}function o(e){var t=e.keys,r=e.index,n=e.subscriber,o=e.subscription,i=e.obj;if(!n.closed)if(r<t.length){var u=t[r];n.next([u,i[u]]),o.add(this.schedule({keys:t,index:r+1,subscriber:n,subscription:o,obj:i}))}else n.complete()}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable"),u=e("../Subscription");r.pairs=n,r.dispatch=o},{"../Observable":65,"../Subscription":73}],95:[function(e,t,r){"use strict";function n(e,t,r){return[u.filter(t,r)(new s.Observable(i.subscribeTo(e))),u.filter(o.not(t,r))(new s.Observable(i.subscribeTo(e)))]}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../util/not"),i=e("../util/subscribeTo"),u=e("../operators/filter"),s=e("../Observable");r.partition=n},{"../Observable":65,"../operators/filter":103,"../util/not":152,"../util/subscribeTo":154}],96:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!i.isArray(e[0]))return e[0];e=e[0]}return u.fromArray(e,void 0).lift(new c)}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,
new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../util/isArray"),u=e("./fromArray"),s=e("../OuterSubscriber"),a=e("../util/subscribeToResult");r.race=n;var c=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new f(e))},e}();r.RaceOperator=c;var f=function(e){function t(t){var r=e.call(this,t)||this;return r.hasFirst=!1,r.observables=[],r.subscriptions=[],r}return o(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var r=0;r<t&&!this.hasFirst;r++){var n=e[r],o=a.subscribeToResult(this,n,n,r);this.subscriptions&&this.subscriptions.push(o),this.add(o)}this.observables=null}},t.prototype.notifyNext=function(e,t,r,n,o){if(!this.hasFirst){this.hasFirst=!0;for(var i=0;i<this.subscriptions.length;i++)if(i!==r){var u=this.subscriptions[i];u.unsubscribe(),this.remove(u)}this.subscriptions=null}this.destination.next(t)},t}(s.OuterSubscriber);r.RaceSubscriber=f},{"../OuterSubscriber":67,"../util/isArray":141,"../util/subscribeToResult":159,"./fromArray":84}],97:[function(e,t,r){"use strict";function n(e,t,r){return void 0===e&&(e=0),new i.Observable(function(n){void 0===t&&(t=e,e=0);var i=0,u=e;if(r)return r.schedule(o,0,{index:i,count:t,start:e,subscriber:n});for(;;){if(i++>=t){n.complete();break}if(n.next(u++),n.closed)break}})}function o(e){var t=e.start,r=e.index,n=e.count,o=e.subscriber;return r>=n?void o.complete():(o.next(t),void(o.closed||(e.index=r+1,e.start=t+1,this.schedule(e))))}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable");r.range=n,r.dispatch=o},{"../Observable":65}],98:[function(e,t,r){"use strict";function n(e,t){return t?new i.Observable(function(r){return t.schedule(o,0,{error:e,subscriber:r})}):new i.Observable(function(t){return t.error(e)})}function o(e){var t=e.error,r=e.subscriber;r.error(t)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable");r.throwError=n},{"../Observable":65}],99:[function(e,t,r){"use strict";function n(e,t,r){void 0===e&&(e=0);var n=-1;return s.isNumeric(t)?n=Number(t)<1&&1||Number(t):a.isScheduler(t)&&(r=t),a.isScheduler(r)||(r=u.async),new i.Observable(function(t){var i=s.isNumeric(e)?e:+e-r.now();return r.schedule(o,i,{index:0,period:n,subscriber:t})})}function o(e){var t=e.index,r=e.period,n=e.subscriber;if(n.next(t),!n.closed){if(r===-1)return n.complete();e.index=t+1,this.schedule(e,r)}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Observable"),u=e("../scheduler/async"),s=e("../util/isNumeric"),a=e("../util/isScheduler");r.timer=n},{"../Observable":65,"../scheduler/async":127,"../util/isNumeric":146,"../util/isScheduler":150}],100:[function(e,t,r){"use strict";function n(e,t){return new o.Observable(function(r){var n;try{n=e()}catch(o){return void r.error(o)}var s;try{s=t(n)}catch(o){return void r.error(o)}var a=s?i.from(s):u.EMPTY,c=a.subscribe(r);return function(){c.unsubscribe(),n&&n.unsubscribe()}})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("./from"),u=e("./empty");r.using=n},{"../Observable":65,"./empty":81,"./from":83}],101:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return"function"==typeof r&&e.pop(),i.fromArray(e,void 0).lift(new l(r))}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("./fromArray"),u=e("../util/isArray"),s=e("../Subscriber"),a=e("../OuterSubscriber"),c=e("../util/subscribeToResult"),f=e("../../internal/symbol/iterator");r.zip=n;var l=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new d(e,this.resultSelector))},e}();r.ZipOperator=l;var d=function(e){function t(t,r,n){void 0===n&&(n=Object.create(null));var o=e.call(this,t)||this;return o.iterators=[],o.active=0,o.resultSelector="function"==typeof r?r:null,o.values=n,o}return o(t,e),t.prototype._next=function(e){var t=this.iterators;u.isArray(e)?t.push(new p(e)):"function"==typeof e[f.iterator]?t.push(new h(e[f.iterator]())):t.push(new b(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0===t)return void this.destination.complete();this.active=t;for(var r=0;r<t;r++){var n=e[r];if(n.stillUnsubscribed){var o=this.destination;o.add(n.subscribe(n,r))}else this.active--}},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,r=this.destination,n=0;n<t;n++){var o=e[n];if("function"==typeof o.hasValue&&!o.hasValue())return}for(var i=!1,u=[],n=0;n<t;n++){var o=e[n],s=o.next();if(o.hasCompleted()&&(i=!0),s.done)return void r.complete();u.push(s.value)}this.resultSelector?this._tryresultSelector(u):r.next(u),i&&r.complete()},t.prototype._tryresultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(r){return void this.destination.error(r)}this.destination.next(t)},t}(s.Subscriber);r.ZipSubscriber=d;var h=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return e&&e.done},e}(),p=function(){function e(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return e.prototype[f.iterator]=function(){return this},e.prototype.next=function(e){var t=this.index++,r=this.array;return t<this.length?{value:r[t],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),b=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.parent=r,o.observable=n,o.stillUnsubscribed=!0,o.buffer=[],o.isComplete=!1,o}return o(t,e),t.prototype[f.iterator]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return this.buffer.length>0},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e,t,r,n,o){this.buffer.push(t),this.parent.checkIterators()},t.prototype.subscribe=function(e,t){return c.subscribeToResult(this,this.observable,this,t)},t}(a.OuterSubscriber)},{"../../internal/symbol/iterator":129,"../OuterSubscriber":67,"../Subscriber":72,"../util/isArray":141,"../util/subscribeToResult":159,"./fromArray":84}],102:[function(e,t,r){"use strict";function n(){return o.mergeAll(1)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./mergeAll");r.concatAll=n},{"./mergeAll":106}],103:[function(e,t,r){"use strict";function n(e,t){return function(r){return r.lift(new u(e,t))}}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Subscriber");r.filter=n;var u=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.predicate,this.thisArg))},e}(),s=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return o(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}t&&this.destination.next(e)},t}(i.Subscriber)},{"../Subscriber":72}],104:[function(e,t,r){"use strict";function n(e,t,r,n){return function(o){return o.lift(new c(e,t,r,n))}}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Subscriber"),u=e("../Subscription"),s=e("../Observable"),a=e("../Subject");r.groupBy=n;var c=function(){function e(e,t,r,n){this.keySelector=e,this.elementSelector=t,this.durationSelector=r,this.subjectSelector=n}return e.prototype.call=function(e,t){return t.subscribe(new f(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},e}(),f=function(e){function t(t,r,n,o,i){var u=e.call(this,t)||this;return u.keySelector=r,u.elementSelector=n,u.durationSelector=o,u.subjectSelector=i,u.groups=null,u.attemptedToUnsubscribe=!1,u.count=0,u}return o(t,e),t.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(r){return void this.error(r)}this._group(e,t)},t.prototype._group=function(e,t){var r=this.groups;r||(r=this.groups=new Map);var n,o=r.get(t);if(this.elementSelector)try{n=this.elementSelector(e)}catch(i){this.error(i)}else n=e;if(!o){o=this.subjectSelector?this.subjectSelector():new a.Subject,r.set(t,o);var u=new d(t,o,this);if(this.destination.next(u),this.durationSelector){var s=void 0;try{s=this.durationSelector(new d(t,o))}catch(i){return void this.error(i)}this.add(s.subscribe(new l(t,o,this)))}}o.closed||o.next(n)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach(function(t,r){t.error(e)}),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach(function(e,t){e.complete()}),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups["delete"](e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},t}(i.Subscriber),l=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.key=t,o.group=r,o.parent=n,o}return o(t,e),t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this,t=e.parent,r=e.key;this.key=this.parent=null,t&&t.removeGroup(r)},t}(i.Subscriber),d=function(e){function t(t,r,n){var o=e.call(this)||this;return o.key=t,o.groupSubject=r,o.refCountSubscription=n,o}return o(t,e),t.prototype._subscribe=function(e){var t=new u.Subscription,r=this,n=r.refCountSubscription,o=r.groupSubject;return n&&!n.closed&&t.add(new h(n)),t.add(o.subscribe(e)),t},t}(s.Observable);r.GroupedObservable=d;var h=function(e){function t(t){var r=e.call(this)||this;return r.parent=t,t.count++,r}return o(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(u.Subscription)},{"../Observable":65,"../Subject":70,"../Subscriber":72,"../Subscription":73}],105:[function(e,t,r){"use strict";function n(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new u(e,t))}}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Subscriber");r.map=n;var u=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.thisArg))},e}();r.MapOperator=u;var s=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return o(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(t)},t}(i.Subscriber)},{"../Subscriber":72}],106:[function(e,t,r){"use strict";function n(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),o.mergeMap(i.identity,e)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./mergeMap"),i=e("../util/identity");r.mergeAll=n},{"../util/identity":140,"./mergeMap":107}],107:[function(e,t,r){"use strict";function n(e,t,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof t?function(o){return o.pipe(n(function(r,n){return c.from(e(r,n)).pipe(a.map(function(e,o){return t(r,e,n,o)}))},r))}:("number"==typeof t&&(r=t),function(t){return t.lift(new f(e,r))})}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../util/subscribeToResult"),u=e("../OuterSubscriber"),s=e("../InnerSubscriber"),a=e("./map"),c=e("../observable/from");r.mergeMap=n;var f=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.project,this.concurrent))},e}();r.MergeMapOperator=f;var l=function(e){function t(t,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var o=e.call(this,t)||this;return o.project=r,o.concurrent=n,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return o(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(t,e,r)},t.prototype._innerSub=function(e,t,r){var n=new s.InnerSubscriber(this,(void 0),(void 0)),o=this.destination;o.add(n),i.subscribeToResult(this,e,t,r,n)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,r,n,o){this.destination.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(u.OuterSubscriber);r.MergeMapSubscriber=l},{"../InnerSubscriber":63,"../OuterSubscriber":67,"../observable/from":83,"../util/subscribeToResult":159,"./map":105}],108:[function(e,t,r){"use strict";function n(e,t){return void 0===t&&(t=0),function(r){return r.lift(new s(e,t))}}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Subscriber"),u=e("../Notification");r.observeOn=n;var s=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new a(e,this.scheduler,this.delay))},e}();r.ObserveOnOperator=s;var a=function(e){function t(t,r,n){void 0===n&&(n=0);var o=e.call(this,t)||this;return o.scheduler=r,o.delay=n,o}return o(t,e),t.dispatch=function(e){var t=e.notification,r=e.destination;t.observe(r),this.unsubscribe()},t.prototype.scheduleMessage=function(e){var r=this.destination;r.add(this.scheduler.schedule(t.dispatch,this.delay,new c(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(u.Notification.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(u.Notification.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(u.Notification.createComplete()),this.unsubscribe()},t}(i.Subscriber);r.ObserveOnSubscriber=a;var c=function(){function e(e,t){this.notification=e,this.destination=t}return e}();r.ObserveOnMessage=c},{"../Notification":64,"../Subscriber":72}],109:[function(e,t,r){"use strict";function n(){return function(e){return e.lift(new u(e))}}var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var i=e("../Subscriber");r.refCount=n;var u=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var r=this.connectable;r._refCount++;var n=new s(e,r),o=t.subscribe(n);return n.closed||(n.connection=r.connect()),o},e}(),s=function(e){function t(t,r){var n=e.call(this,t)||this;return n.connectable=r,n}return o(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(!e)return void(this.connection=null);this.connectable=null;var t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);var r=this.connection,n=e._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()},t}(i.Subscriber)},{"../Subscriber":72}],110:[function(e,t,r){"use strict";function n(e,t){return new o.Observable(function(r){var n=new i.Subscription,o=0;return n.add(t.schedule(function(){return o===e.length?void r.complete():(r.next(e[o++]),void(r.closed||n.add(this.schedule())))})),n})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../Subscription");r.scheduleArray=n},{"../Observable":65,"../Subscription":73}],111:[function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error("Iterable cannot be null");return new o.Observable(function(r){var n,o=new i.Subscription;return o.add(function(){n&&"function"==typeof n["return"]&&n["return"]()}),o.add(t.schedule(function(){n=e[u.iterator](),o.add(t.schedule(function(){if(!r.closed){var e,t;try{var o=n.next();e=o.value,t=o.done}catch(i){return void r.error(i)}t?r.complete():(r.next(e),this.schedule())}}))})),o})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../Subscription"),u=e("../symbol/iterator");r.scheduleIterable=n},{"../Observable":65,"../Subscription":73,"../symbol/iterator":129}],112:[function(e,t,r){"use strict";function n(e,t){return new o.Observable(function(r){var n=new i.Subscription;return n.add(t.schedule(function(){var o=e[u.observable]();n.add(o.subscribe({next:function(e){n.add(t.schedule(function(){return r.next(e)}))},error:function(e){n.add(t.schedule(function(){return r.error(e)}))},complete:function(){n.add(t.schedule(function(){return r.complete()}))}}))})),n})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../Subscription"),u=e("../symbol/observable");r.scheduleObservable=n},{"../Observable":65,"../Subscription":73,"../symbol/observable":130}],113:[function(e,t,r){"use strict";function n(e,t){return new o.Observable(function(r){var n=new i.Subscription;return n.add(t.schedule(function(){return e.then(function(e){n.add(t.schedule(function(){r.next(e),n.add(t.schedule(function(){return r.complete()}))}))},function(e){n.add(t.schedule(function(){return r.error(e)}))})})),n})}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable"),i=e("../Subscription");r.schedulePromise=n},{"../Observable":65,"../Subscription":73}],114:[function(e,t,r){"use strict";function n(e,t){if(null!=e){if(a.isInteropObservable(e))return o.scheduleObservable(e,t);if(c.isPromise(e))return i.schedulePromise(e,t);if(f.isArrayLike(e))return u.scheduleArray(e,t);if(l.isIterable(e)||"string"==typeof e)return s.scheduleIterable(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./scheduleObservable"),i=e("./schedulePromise"),u=e("./scheduleArray"),s=e("./scheduleIterable"),a=e("../util/isInteropObservable"),c=e("../util/isPromise"),f=e("../util/isArrayLike"),l=e("../util/isIterable");r.scheduled=n},{"../util/isArrayLike":142,"../util/isInteropObservable":144,"../util/isIterable":145,"../util/isPromise":149,"./scheduleArray":110,"./scheduleIterable":111,"./scheduleObservable":112,"./schedulePromise":113}],115:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Subscription"),i=function(e){function t(t,r){return e.call(this)||this}return n(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(o.Subscription);r.Action=i},{"../Subscription":73}],116:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AsyncAction"),i=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return n(t,e),t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0?e.prototype.requestAsyncId.call(this,t,r,n):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(function(){return t.flush(null)})))},t.prototype.recycleAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?e.prototype.recycleAsyncId.call(this,t,r,n):void(0===t.actions.length&&(cancelAnimationFrame(r),t.scheduled=void 0))},t}(o.AsyncAction);r.AnimationFrameAction=i},{"./AsyncAction":120}],117:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AsyncScheduler"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,n=-1,o=r.length;e=e||r.shift();do if(t=e.execute(e.state,e.delay))break;while(++n<o&&(e=r.shift()));if(this.active=!1,t){for(;++n<o&&(e=r.shift());)e.unsubscribe();throw t}},t}(o.AsyncScheduler);r.AnimationFrameScheduler=i},{"./AsyncScheduler":121}],118:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("../util/Immediate"),i=e("./AsyncAction"),u=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return n(t,e),t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0?e.prototype.requestAsyncId.call(this,t,r,n):(t.actions.push(this),t.scheduled||(t.scheduled=o.Immediate.setImmediate(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?e.prototype.recycleAsyncId.call(this,t,r,n):void(0===t.actions.length&&(o.Immediate.clearImmediate(r),t.scheduled=void 0))},t}(i.AsyncAction);r.AsapAction=u},{"../util/Immediate":134,"./AsyncAction":120}],119:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AsyncScheduler"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,n=-1,o=r.length;e=e||r.shift();do if(t=e.execute(e.state,e.delay))break;while(++n<o&&(e=r.shift()));if(this.active=!1,t){for(;++n<o&&(e=r.shift());)e.unsubscribe();throw t}},t}(o.AsyncScheduler);r.AsapScheduler=i},{"./AsyncScheduler":121}],120:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Action"),i=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return n(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){return void 0===r&&(r=0),null!==r&&this.delay===r&&this.pending===!1?t:void clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);return r?r:void(this.pending===!1&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null)))},t.prototype._execute=function(e,t){var r=!1,n=void 0;try{this.work(e)}catch(o){r=!0,n=!!o&&o||new Error(o)}if(r)return this.unsubscribe(),n},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,r=t.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,n!==-1&&r.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(o.Action);r.AsyncAction=i},{"./Action":115}],121:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Scheduler"),i=function(e){function t(r,n){void 0===n&&(n=o.Scheduler.now);var i=e.call(this,r,function(){return t.delegate&&t.delegate!==i?t.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return n(t,e),t.prototype.schedule=function(r,n,o){return void 0===n&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(r,n,o):e.prototype.schedule.call(this,r,n,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)return void t.push(e);var r;this.active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}},t}(o.Scheduler);r.AsyncScheduler=i},{"../Scheduler":69}],122:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AsyncAction"),i=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return n(t,e),t.prototype.schedule=function(t,r){return void 0===r&&(r=0),r>0?e.prototype.schedule.call(this,t,r):(this.delay=r,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,r){return r>0||this.closed?e.prototype.execute.call(this,t,r):this._execute(t,r)},t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?e.prototype.requestAsyncId.call(this,t,r,n):t.flush(this)},t}(o.AsyncAction);r.QueueAction=i},{"./AsyncAction":120}],123:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AsyncScheduler"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.AsyncScheduler);r.QueueScheduler=i},{"./AsyncScheduler":121}],124:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AsyncAction"),i=e("./AsyncScheduler"),u=function(e){function t(t,r){void 0===t&&(t=s),void 0===r&&(r=Number.POSITIVE_INFINITY);var n=e.call(this,t,function(){return n.frame})||this;return n.maxFrames=r,n.frame=0,n.index=-1,n}return n(t,e),t.prototype.flush=function(){for(var e,t,r=this,n=r.actions,o=r.maxFrames;(t=n[0])&&t.delay<=o&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(i.AsyncScheduler);r.VirtualTimeScheduler=u;var s=function(e){function t(t,r,n){void 0===n&&(n=t.index+=1);var o=e.call(this,t,r)||this;return o.scheduler=t,o.work=r,o.index=n,o.active=!0,o.index=t.index=n,o}return n(t,e),t.prototype.schedule=function(r,n){if(void 0===n&&(n=0),!this.id)return e.prototype.schedule.call(this,r,n);this.active=!1;var o=new t(this.scheduler,this.work);return this.add(o),o.schedule(r,n)},t.prototype.requestAsyncId=function(e,r,n){void 0===n&&(n=0),this.delay=e.frame+n;var o=e.actions;return o.push(this),o.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,r){void 0===r&&(r=0)},t.prototype._execute=function(t,r){if(this.active===!0)return e.prototype._execute.call(this,t,r);
},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(o.AsyncAction);r.VirtualAction=s},{"./AsyncAction":120,"./AsyncScheduler":121}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./AnimationFrameAction"),o=e("./AnimationFrameScheduler");r.animationFrame=new o.AnimationFrameScheduler(n.AnimationFrameAction)},{"./AnimationFrameAction":116,"./AnimationFrameScheduler":117}],126:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./AsapAction"),o=e("./AsapScheduler");r.asap=new o.AsapScheduler(n.AsapAction)},{"./AsapAction":118,"./AsapScheduler":119}],127:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./AsyncAction"),o=e("./AsyncScheduler");r.async=new o.AsyncScheduler(n.AsyncAction)},{"./AsyncAction":120,"./AsyncScheduler":121}],128:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./QueueAction"),o=e("./QueueScheduler");r.queue=new o.QueueScheduler(n.QueueAction)},{"./QueueAction":122,"./QueueScheduler":123}],129:[function(e,t,r){"use strict";function n(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}Object.defineProperty(r,"__esModule",{value:!0}),r.getSymbolIterator=n,r.iterator=n(),r.$$iterator=r.iterator},{}],130:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"},{}],131:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),r.$$rxSubscriber=r.rxSubscriber},{}],132:[function(e,t,r){"use strict";function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}Object.defineProperty(r,"__esModule",{value:!0}),n.prototype=Object.create(Error.prototype),r.ArgumentOutOfRangeError=n},{}],133:[function(e,t,r){"use strict";function n(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Object.defineProperty(r,"__esModule",{value:!0}),n.prototype=Object.create(Error.prototype),r.EmptyError=n},{}],134:[function(e,t,r){"use strict";function n(e){var t=i[e];t&&t()}Object.defineProperty(r,"__esModule",{value:!0});var o=1,i={};r.Immediate={setImmediate:function(e){var t=o++;return i[t]=e,Promise.resolve().then(function(){return n(t)}),t},clearImmediate:function(e){delete i[e]}}},{}],135:[function(e,t,r){"use strict";function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}Object.defineProperty(r,"__esModule",{value:!0}),n.prototype=Object.create(Error.prototype),r.ObjectUnsubscribedError=n},{}],136:[function(e,t,r){"use strict";function n(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}Object.defineProperty(r,"__esModule",{value:!0}),n.prototype=Object.create(Error.prototype),r.TimeoutError=n},{}],137:[function(e,t,r){"use strict";function n(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}Object.defineProperty(r,"__esModule",{value:!0}),n.prototype=Object.create(Error.prototype),r.UnsubscriptionError=n},{}],138:[function(e,t,r){"use strict";function n(e){for(;e;){var t=e,r=t.closed,n=t.destination,i=t.isStopped;if(r||i)return!1;e=n&&n instanceof o.Subscriber?n:null}return!0}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Subscriber");r.canReportError=n},{"../Subscriber":72}],139:[function(e,t,r){"use strict";function n(e){setTimeout(function(){throw e},0)}Object.defineProperty(r,"__esModule",{value:!0}),r.hostReportError=n},{}],140:[function(e,t,r){"use strict";function n(e){return e}Object.defineProperty(r,"__esModule",{value:!0}),r.identity=n},{}],141:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},{}],142:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},{}],143:[function(e,t,r){"use strict";function n(e){return"function"==typeof e}Object.defineProperty(r,"__esModule",{value:!0}),r.isFunction=n},{}],144:[function(e,t,r){"use strict";function n(e){return e&&"function"==typeof e[o.observable]}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../symbol/observable");r.isInteropObservable=n},{"../symbol/observable":130}],145:[function(e,t,r){"use strict";function n(e){return e&&"function"==typeof e[o.iterator]}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../symbol/iterator");r.isIterable=n},{"../symbol/iterator":129}],146:[function(e,t,r){"use strict";function n(e){return!o.isArray(e)&&e-parseFloat(e)+1>=0}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./isArray");r.isNumeric=n},{"./isArray":141}],147:[function(e,t,r){"use strict";function n(e){return null!==e&&"object"==typeof e}Object.defineProperty(r,"__esModule",{value:!0}),r.isObject=n},{}],148:[function(e,t,r){"use strict";function n(e){return!!e&&(e instanceof o.Observable||"function"==typeof e.lift&&"function"==typeof e.subscribe)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Observable");r.isObservable=n},{"../Observable":65}],149:[function(e,t,r){"use strict";function n(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}Object.defineProperty(r,"__esModule",{value:!0}),r.isPromise=n},{}],150:[function(e,t,r){"use strict";function n(e){return e&&"function"==typeof e.schedule}Object.defineProperty(r,"__esModule",{value:!0}),r.isScheduler=n},{}],151:[function(e,t,r){"use strict";function n(){}Object.defineProperty(r,"__esModule",{value:!0}),r.noop=n},{}],152:[function(e,t,r){"use strict";function n(e,t){function r(){return!r.pred.apply(r.thisArg,arguments)}return r.pred=e,r.thisArg=t,r}Object.defineProperty(r,"__esModule",{value:!0}),r.not=n},{}],153:[function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o(e)}function o(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:i.noop}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./noop");r.pipe=n,r.pipeFromArray=o},{"./noop":151}],154:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./subscribeToArray"),o=e("./subscribeToPromise"),i=e("./subscribeToIterable"),u=e("./subscribeToObservable"),s=e("./isArrayLike"),a=e("./isPromise"),c=e("./isObject"),f=e("../symbol/iterator"),l=e("../symbol/observable");r.subscribeTo=function(e){if(e&&"function"==typeof e[l.observable])return u.subscribeToObservable(e);if(s.isArrayLike(e))return n.subscribeToArray(e);if(a.isPromise(e))return o.subscribeToPromise(e);if(e&&"function"==typeof e[f.iterator])return i.subscribeToIterable(e);var t=c.isObject(e)?"an invalid object":"'"+e+"'",r="You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(r)}},{"../symbol/iterator":129,"../symbol/observable":130,"./isArrayLike":142,"./isObject":147,"./isPromise":149,"./subscribeToArray":155,"./subscribeToIterable":156,"./subscribeToObservable":157,"./subscribeToPromise":158}],155:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.subscribeToArray=function(e){return function(t){for(var r=0,n=e.length;r<n&&!t.closed;r++)t.next(e[r]);t.complete()}}},{}],156:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../symbol/iterator");r.subscribeToIterable=function(e){return function(t){for(var r=e[n.iterator]();;){var o=r.next();if(o.done){t.complete();break}if(t.next(o.value),t.closed)break}return"function"==typeof r["return"]&&t.add(function(){r["return"]&&r["return"]()}),t}}},{"../symbol/iterator":129}],157:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../symbol/observable");r.subscribeToObservable=function(e){return function(t){var r=e[n.observable]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(t)}}},{"../symbol/observable":130}],158:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./hostReportError");r.subscribeToPromise=function(e){return function(t){return e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,n.hostReportError),t}}},{"./hostReportError":139}],159:[function(e,t,r){"use strict";function n(e,t,r,n,s){if(void 0===s&&(s=new o.InnerSubscriber(e,r,n)),!s.closed)return t instanceof u.Observable?t.subscribe(s):i.subscribeTo(t)(s)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../InnerSubscriber"),i=e("./subscribeTo"),u=e("../Observable");r.subscribeToResult=n},{"../InnerSubscriber":63,"../Observable":65,"./subscribeTo":154}],160:[function(e,t,r){"use strict";function n(e,t,r){if(e){if(e instanceof o.Subscriber)return e;if(e[i.rxSubscriber])return e[i.rxSubscriber]()}return e||t||r?new o.Subscriber(e,t,r):new o.Subscriber(u.empty)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../Subscriber"),i=e("../symbol/rxSubscriber"),u=e("../Observer");r.toSubscriber=n},{"../Observer":66,"../Subscriber":72,"../symbol/rxSubscriber":131}]},{},[32])(32)});